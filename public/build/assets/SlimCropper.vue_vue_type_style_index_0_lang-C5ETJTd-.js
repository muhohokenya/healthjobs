import{d as ki,H as ke,o as Ci,n as Ei,w as xi,V as Ti,f as Ce,e as Ee,x as Ri,g as Pi,I as xe,z as Ii}from"./app-DDPyPF-p.js";const Mi=typeof window<"u"?(function(){(function(){if(typeof window.CustomEvent=="function")return!1;function h(n,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var i=document.createEvent("CustomEvent");return i.initCustomEvent(n,t.bubbles,t.cancelable,t.detail),i}h.prototype=window.Event.prototype,window.CustomEvent=h})();var b=function(h,n,t){var i=document.createElement("img"),e,o;if(i.onerror=n,i.onload=function(){o&&!(t&&t.noRevoke)&&b.revokeObjectURL(o),n&&n(b.scale(i,t))},b.isInstanceOf("Blob",h)||b.isInstanceOf("File",h))e=o=b.createObjectURL(h),i._type=h.type;else if(typeof h=="string")e=h,t&&t.crossOrigin&&(i.crossOrigin=t.crossOrigin);else return!1;return e?(i.src=e,i):b.readFile(h,function(a){var s=a.target;s&&s.result?i.src=s.result:n&&n(a)})},B=window.createObjectURL&&window||window.URL&&URL.revokeObjectURL&&URL||window.webkitURL&&webkitURL;b.isInstanceOf=function(h,n){return Object.prototype.toString.call(n)==="[object "+h+"]"},b.transformCoordinates=function(){},b.getTransformedOptions=function(h,n){var t=n.aspectRatio,i,e,o,a;if(!t)return n;i={};for(e in n)n.hasOwnProperty(e)&&(i[e]=n[e]);return i.crop=!0,o=h.naturalWidth||h.width,a=h.naturalHeight||h.height,o/a>t?(i.maxWidth=a*t,i.maxHeight=a):(i.maxWidth=o,i.maxHeight=o/t),i},b.renderImageToCanvas=function(h,n,t,i,e,o,a,s,f,l){return h.getContext("2d").drawImage(n,t,i,e,o,a,s,f,l),h},b.hasCanvasOption=function(h){return h.canvas||h.crop||!!h.aspectRatio},b.scale=function(h,n){n=n||{};var t=document.createElement("canvas"),i=h.getContext||b.hasCanvasOption(n)&&t.getContext,e=h.naturalWidth||h.width,o=h.naturalHeight||h.height,a=e,s=o,f,l,v,p,d,y,E,m,_,k,C;function U(){var L=Math.max((v||a)/a,(p||s)/s);L>1&&(a*=L,s*=L)}function z(){var L=Math.min((f||a)/a,(l||s)/s);L<1&&(a*=L,s*=L)}if(i&&(n=b.getTransformedOptions(h,n),E=n.left||0,m=n.top||0,n.sourceWidth?(d=n.sourceWidth,n.right!==void 0&&n.left===void 0&&(E=e-d-n.right)):d=e-E-(n.right||0),n.sourceHeight?(y=n.sourceHeight,n.bottom!==void 0&&n.top===void 0&&(m=o-y-n.bottom)):y=o-m-(n.bottom||0),a=d,s=y),f=n.maxWidth,l=n.maxHeight,v=n.minWidth,p=n.minHeight,i&&f&&l&&n.crop?(a=f,s=l,C=d/y-f/l,C<0?(y=l*d/f,n.top===void 0&&n.bottom===void 0&&(m=(o-y)/2)):C>0&&(d=f*y/l,n.left===void 0&&n.right===void 0&&(E=(e-d)/2))):((n.contain||n.cover)&&(v=f=f||v,p=l=l||p),n.cover?(z(),U()):(U(),z())),i){if(_=n.pixelRatio,_>1&&(t.style.width=a+"px",t.style.height=s+"px",a*=_,s*=_,t.getContext("2d").scale(_,_)),k=n.downsamplingRatio,k>0&&k<1&&a<d&&s<y)for(;d*k>a;)t.width=d*k,t.height=y*k,b.renderImageToCanvas(t,h,E,m,d,y,0,0,t.width,t.height),d=t.width,y=t.height,h=document.createElement("canvas"),h.width=d,h.height=y,b.renderImageToCanvas(h,t,0,0,d,y,0,0,d,y);return t.width=a,t.height=s,b.transformCoordinates(t,n),b.renderImageToCanvas(t,h,E,m,d,y,0,0,a,s)}return h.width=a,h.height=s,h},b.createObjectURL=function(h){return B?B.createObjectURL(h):!1},b.revokeObjectURL=function(h){return B?B.revokeObjectURL(h):!1},b.readFile=function(h,n,t){if(window.FileReader){var i=new FileReader;if(i.onload=i.onerror=n,t=t||"readAsDataURL",i[t])return i[t](h),i}return!1};var Nt=b.hasCanvasOption,Wt=b.transformCoordinates,yt=b.getTransformedOptions;b.hasCanvasOption=function(h){return!!h.orientation||Nt.call(b,h)},b.transformCoordinates=function(h,n){Wt.call(b,h,n);var t=h.getContext("2d"),i=h.width,e=h.height,o=h.style.width,a=h.style.height,s=n.orientation;if(!(!s||s>8))switch(s>4&&(h.width=e,h.height=i,h.style.width=a,h.style.height=o),s){case 2:t.translate(i,0),t.scale(-1,1);break;case 3:t.translate(i,e),t.rotate(Math.PI);break;case 4:t.translate(0,e),t.scale(1,-1);break;case 5:t.rotate(.5*Math.PI),t.scale(1,-1);break;case 6:t.rotate(.5*Math.PI),t.translate(0,-e);break;case 7:t.rotate(.5*Math.PI),t.translate(i,-e),t.scale(-1,1);break;case 8:t.rotate(-.5*Math.PI),t.translate(-i,0);break}},b.getTransformedOptions=function(h,n){var t=yt.call(b,h,n),i=t.orientation,e,o;if(!i||i>8||i===1)return t;e={};for(o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);switch(t.orientation){case 2:e.left=t.right,e.right=t.left;break;case 3:e.left=t.right,e.top=t.bottom,e.right=t.left,e.bottom=t.top;break;case 4:e.top=t.bottom,e.bottom=t.top;break;case 5:e.left=t.top,e.top=t.left,e.right=t.bottom,e.bottom=t.right;break;case 6:e.left=t.top,e.top=t.right,e.right=t.bottom,e.bottom=t.left;break;case 7:e.left=t.bottom,e.top=t.right,e.right=t.top,e.bottom=t.left;break;case 8:e.left=t.bottom,e.top=t.left,e.right=t.top,e.bottom=t.right;break}return t.orientation>4&&(e.maxWidth=t.maxHeight,e.maxHeight=t.maxWidth,e.minWidth=t.minHeight,e.minHeight=t.minWidth,e.sourceWidth=t.sourceHeight,e.sourceHeight=t.sourceWidth),e};var qt=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);b.blobSlice=qt&&function(){var h=this.slice||this.webkitSlice||this.mozSlice;return h.apply(this,arguments)},b.metaDataParsers={jpeg:{65505:[]}},b.parseMetaData=function(h,n,t){t=t||{};var i=this,e=t.maxMetaDataSize||262144,o={},a=!(window.DataView&&h&&h.size>=12&&h.type==="image/jpeg"&&b.blobSlice);(a||!b.readFile(b.blobSlice.call(h,0,e),function(s){if(s.target.error){n(o);return}var f=s.target.result,l=new DataView(f),v=2,p=l.byteLength-4,d=v,y,E,m,_;if(l.getUint16(0)===65496){for(;v<p&&(y=l.getUint16(v),y>=65504&&y<=65519||y===65534);){if(E=l.getUint16(v+2)+2,v+E>l.byteLength)break;if(m=b.metaDataParsers.jpeg[y],m)for(_=0;_<m.length;_+=1)m[_].call(i,l,v,E,o,t);v+=E,d=v}!t.disableImageHead&&d>6&&(f.slice?o.imageHead=f.slice(0,d):o.imageHead=new Uint8Array(f).subarray(0,d))}n(o)},"readAsArrayBuffer"))&&n(o)},b.ExifMap=function(){return this},b.ExifMap.prototype.map={Orientation:274},b.ExifMap.prototype.get=function(h){return this[h]||this[this.map[h]]},b.getExifThumbnail=function(h,n,t){var i,e,o;if(!(!t||n+t>h.byteLength)){for(i=[],e=0;e<t;e+=1)o=h.getUint8(n+e),i.push((o<16?"0":"")+o.toString(16));return"data:image/jpeg,%"+i.join("%")}},b.exifTagTypes={1:{getValue:function(h,n){return h.getUint8(n)},size:1},2:{getValue:function(h,n){return String.fromCharCode(h.getUint8(n))},size:1,ascii:!0},3:{getValue:function(h,n,t){return h.getUint16(n,t)},size:2},4:{getValue:function(h,n,t){return h.getUint32(n,t)},size:4},5:{getValue:function(h,n,t){return h.getUint32(n,t)/h.getUint32(n+4,t)},size:8},9:{getValue:function(h,n,t){return h.getInt32(n,t)},size:4},10:{getValue:function(h,n,t){return h.getInt32(n,t)/h.getInt32(n+4,t)},size:8}},b.exifTagTypes[7]=b.exifTagTypes[1],b.getExifValue=function(h,n,t,i,e,o){var a=b.exifTagTypes[i],s,f,l,v,p,d;if(a&&(s=a.size*e,f=s>4?n+h.getUint32(t+8,o):t+8,!(f+s>h.byteLength))){if(e===1)return a.getValue(h,f,o);for(l=[],v=0;v<e;v+=1)l[v]=a.getValue(h,f+v*a.size,o);if(a.ascii){for(p="",v=0;v<l.length&&(d=l[v],d!=="\0");v+=1)p+=d;return p}return l}},b.parseExifTag=function(h,n,t,i,e){var o=h.getUint16(t,i);e.exif[o]=b.getExifValue(h,n,t,h.getUint16(t+2,i),h.getUint32(t+4,i),i)},b.parseExifTags=function(h,n,t,i,e){var o,a,s;if(!(t+6>h.byteLength)&&(o=h.getUint16(t,i),a=t+2+12*o,!(a+4>h.byteLength))){for(s=0;s<o;s+=1)this.parseExifTag(h,n,t+2+12*s,i,e);return h.getUint32(a,i)}},b.parseExifData=function(h,n,t,i,e){if(!e.disableExif){var o=n+10,a,s,f;if(h.getUint32(n+4)===1165519206&&!(o+8>h.byteLength)&&h.getUint16(n+8)===0){switch(h.getUint16(o)){case 18761:a=!0;break;case 19789:a=!1;break;default:return}h.getUint16(o+2,a)===42&&(s=h.getUint32(o+4,a),i.exif=new b.ExifMap,s=b.parseExifTags(h,o,o+s,a,i),s&&!e.disableExifThumbnail&&(f={exif:{}},s=b.parseExifTags(h,o,o+s,a,f),f.exif[513]&&(i.exif.Thumbnail=b.getExifThumbnail(h,o+f.exif[513],f.exif[514]))),i.exif[34665]&&!e.disableExifSub&&b.parseExifTags(h,o,o+i.exif[34665],a,i),i.exif[34853]&&!e.disableExifGps&&b.parseExifTags(h,o,o+i.exif[34853],a,i))}}},b.metaDataParsers.jpeg[65505].push(b.parseExifData);var x=(function(){var h=[],n=[],t=[],i="transform",e=window.getComputedStyle(document.documentElement,""),o=(Array.prototype.slice.call(e).join("").match(/-(moz|webkit|ms)-/)||e.OLink===""&&["","o"])[1];o==="webkit"&&(i="webkitTransform");var a=function(r,u,g){var c=r;if(c.length!==void 0){for(var w={chainers:[],then:function(R){return this.snabbt(R)},snabbt:function(R){var P=this.chainers.length;return this.chainers.forEach(function(I,D){I.snabbt(s(R,D,P))}),w},setValue:function(R){return this.chainers.forEach(function(P){P.setValue(R)}),w},finish:function(){return this.chainers.forEach(function(R){R.finish()}),w},rollback:function(){return this.chainers.forEach(function(R){R.rollback()}),w}},S=0,T=c.length;S<T;++S)typeof u=="string"?w.chainers.push(f(c[S],u,s(g,S,T))):w.chainers.push(f(c[S],s(u,S,T),g));return w}else return typeof u=="string"?f(c,u,s(g,0,1)):f(c,s(u,0,1),g)},s=function(r,u,g){if(!r)return r;var c=ee(r);Y(r.delay)&&(c.delay=r.delay(u,g)),Y(r.callback)&&(c.complete=function(){r.callback.call(this,u,g)});var w=Y(r.allDone),S=Y(r.complete);(S||w)&&(c.complete=function(){S&&r.complete.call(this,u,g),w&&u==g-1&&r.allDone()}),Y(r.valueFeeder)&&(c.valueFeeder=function(R,P){return r.valueFeeder(R,P,u,g)}),Y(r.easing)&&(c.easing=function(R){return r.easing(R,u,g)});var T=["position","rotation","skew","rotationPost","scale","width","height","opacity","fromPosition","fromRotation","fromSkew","fromRotationPost","fromScale","fromWidth","fromHeight","fromOpacity","transformOrigin","duration","delay"];return T.forEach(function(R){Y(r[R])&&(c[R]=r[R](u,g))}),c},f=function(r,u,g){if(u==="attention")return l(r,g);if(u==="stop")return v(r);if(u==="detach")return d(r);var c=u;m();var w=k(r),S=w;S=C(c,S,!0);var T=ee(w);T=C(c,T);var R=U(S,T,c),P=q(R);n.push([r,P]),P.updateElement(r,!0);var I=[],D={snabbt:function(et){return I.unshift(s(et,0,1)),D},then:function(et){return this.snabbt(et)}};function tt(et){if(P.tick(et),P.updateElement(r),!P.isStopped()){if(!P.completed())return L(tt);c.loop>1&&!P.isStopped()?(c.loop-=1,P.restart(),L(tt)):(c.complete&&c.complete.call(r),I.length&&(c=I.pop(),S=C(c,T,!0),T=C(c,ee(T)),c=U(S,T,c),P=q(c),n.push([r,P]),P.tick(et),L(tt)))}}return L(tt),c.manual?P:D},l=function(r,u){var g=C(u,lt({}));u.movement=g;var c=Z(u);n.push([r,c]);function w(S){c.tick(S),c.updateElement(r),c.completed()?(u.callback&&u.callback(r),u.loop&&u.loop>1&&(u.loop--,c.restart(),L(w))):L(w)}L(w)},v=function(r){for(var u=0,g=n.length;u<g;++u){var c=n[u],w=c[0],S=c[1];w===r&&S.stop()}},p=function(r,u){for(var g=0,c=r.length;g<c;++g)if(r[g][0]===u)return g;return-1},d=function(r){var u=[],g=n.concat(t),c,w,S=g.length;for(w=0;w<S;++w)c=g[w][0],(r.contains(c)||r===c)&&u.push(c);for(S=u.length,w=0;w<S;++w)y(u[w])},y=function(r){v(r);var u=p(n,r);u>=0&&n.splice(u,1),u=p(t,r),u>=0&&t.splice(u,1)},E=function(r,u){for(var g=0,c=r.length;g<c;++g){var w=r[g],S=w[0],T=w[1];if(S===u){var R=T.getCurrentState();return T.stop(),R}}},m=function(){t=t.filter(function(r){return _(r[0]).body})},_=function(r){for(var u=r;u.parentNode;)u=u.parentNode;return u},k=function(r){var u=E(n,r);return u||E(t,r)},C=function(r,u,g){u||(u=lt({position:[0,0,0],rotation:[0,0,0],rotationPost:[0,0,0],scale:[1,1],skew:[0,0]}));var c="position",w="rotation",S="skew",T="rotationPost",R="scale",P="scalePost",I="width",D="height",tt="opacity";return g&&(c="fromPosition",w="fromRotation",S="fromSkew",T="fromRotationPost",R="fromScale",P="fromScalePost",I="fromWidth",D="fromHeight",tt="fromOpacity"),u.position=M(r[c],u.position),u.rotation=M(r[w],u.rotation),u.rotationPost=M(r[T],u.rotationPost),u.skew=M(r[S],u.skew),u.scale=M(r[R],u.scale),u.scalePost=M(r[P],u.scalePost),u.opacity=r[tt],u.width=r[I],u.height=r[D],u},U=function(r,u,g){return g.startState=r,g.endState=u,g},z=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(r){return setTimeout(r,1e3/60)},L=function(r){h.length===0&&z(W),h.push(r)},W=function(r){for(var u=h.length,g=0;g<u;++g)h[g](r);h.splice(0,u);var c=n.filter(function(w){return w[1].completed()});t=t.filter(function(w){for(var S=0,T=c.length;S<T;++S)if(w[0]===c[S][0])return!1;return!0}),t=t.concat(c),n=n.filter(function(w){return!w[1].completed()}),h.length!==0&&z(W)},q=function(r){var u=r.startState,g=r.endState,c=M(r.duration,500),w=M(r.delay,0),S=r.perspective,T=ut(M(r.easing,"linear"),r),R=c===0?g.clone():u.clone();r.transformOrigin,R.transformOrigin=r.transformOrigin;var P=0,I=0,D=!1,tt=!1,et=r.manual,bt=0,N=w/c,xt,kt;return r.valueFeeder?kt=Ht(r.valueFeeder,u,g,R):kt=O(u,g,R),{stop:function(){D=!0},isStopped:function(){return D},finish:function(X){et=!1;var pt=c*bt;P=I-pt,xt=X,T.resetFrom=bt},rollback:function(X){et=!1,kt.setReverse();var pt=c*(1-bt);P=I-pt,xt=X,T.resetFrom=bt},restart:function(){P=void 0,T.resetFrom(0)},tick:function(X){if(!D){if(et){I=X,this.updateCurrentTransform();return}if(P||(P=X),X-P>w){tt=!0,I=X-w;var pt=Math.min(Math.max(0,I-P),c);T.tick(pt/c),this.updateCurrentTransform(),this.completed()&&xt&&xt()}}},getCurrentState:function(){return R},setValue:function(X){tt=!0,bt=Math.min(Math.max(X,1e-4),1+N)},updateCurrentTransform:function(){var X=T.getValue();if(et){var pt=Math.max(1e-5,bt-N);T.tick(pt),X=T.getValue()}kt.tween(X)},completed:function(){return D?!0:P===0?!1:T.completed()},updateElement:function(X,pt){if(!(!tt&&!pt)){var ie=kt.asMatrix(),ne=kt.getProperties();j(X,ie,S),ft(X,ne)}}}},Z=function(r){var u=r.movement;r.initialVelocity=.1,r.equilibriumPosition=0;var g=at(r),c=!1,w=u.position,S=u.rotation,T=u.rotationPost,R=u.scale,P=u.skew,I=lt({position:w?[0,0,0]:void 0,rotation:S?[0,0,0]:void 0,rotationPost:T?[0,0,0]:void 0,scale:R?[0,0]:void 0,skew:P?[0,0]:void 0});return{stop:function(){c=!0},isStopped:function(D){return c},tick:function(D){c||g.equilibrium||(g.tick(),this.updateMovement())},updateMovement:function(){var D=g.getValue();w&&(I.position[0]=u.position[0]*D,I.position[1]=u.position[1]*D,I.position[2]=u.position[2]*D),S&&(I.rotation[0]=u.rotation[0]*D,I.rotation[1]=u.rotation[1]*D,I.rotation[2]=u.rotation[2]*D),T&&(I.rotationPost[0]=u.rotationPost[0]*D,I.rotationPost[1]=u.rotationPost[1]*D,I.rotationPost[2]=u.rotationPost[2]*D),R&&(I.scale[0]=1+u.scale[0]*D,I.scale[1]=1+u.scale[1]*D),P&&(I.skew[0]=u.skew[0]*D,I.skew[1]=u.skew[1]*D)},updateElement:function(D){j(D,I.asMatrix()),ft(D,I.getProperties())},getCurrentState:function(){return I},completed:function(){return g.equilibrium||c},restart:function(){g=at(r)}}},V=function(r){return r},dt=function(r){return(Math.cos(r*Math.PI+Math.PI)+1)/2},ct=function(r){return r*r},st=function(r){return-Math.pow(r-1,2)+1},at=function(r){var u=M(r.startPosition,0),g=M(r.equilibriumPosition,1),c=M(r.initialVelocity,0),w=M(r.springConstant,.8),S=M(r.springDeceleration,.9),T=M(r.springMass,10),R=!1;return{tick:function(P){if(P!==0&&!R){var I=-(u-g)*w,D=I/T;c+=D,u+=c,c*=S,Math.abs(u-g)<.001&&Math.abs(c)<.001&&(R=!0)}},resetFrom:function(P){u=P,c=0},getValue:function(){return R?g:u},completed:function(){return R}}},ht={linear:V,ease:dt,easeIn:ct,easeOut:st},ut=function(r,u){if(r=="spring")return at(u);var g=r;Y(r)||(g=ht[r]);var c=g,w=0,S;return{tick:function(T){w=c(T),S=T},resetFrom:function(T){S=0},getValue:function(){return w},completed:function(){return S>=1?S:!1}}},J=function(r,u,g,c){r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=u,r[13]=g,r[14]=c,r[15]=1},$=function(r,u){r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=Math.cos(u),r[6]=-Math.sin(u),r[7]=0,r[8]=0,r[9]=Math.sin(u),r[10]=Math.cos(u),r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1},K=function(r,u){r[0]=Math.cos(u),r[1]=0,r[2]=Math.sin(u),r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=-Math.sin(u),r[9]=0,r[10]=Math.cos(u),r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1},A=function(r,u){r[0]=Math.cos(u),r[1]=-Math.sin(u),r[2]=0,r[3]=0,r[4]=Math.sin(u),r[5]=Math.cos(u),r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1},vt=function(r,u,g){r[0]=1,r[1]=Math.tan(u),r[2]=0,r[3]=0,r[4]=Math.tan(g),r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1},te=function(r,u,g){r[0]=u,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=g,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1},Ct=function(r){r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1},_t=function(r,u){u[0]=r[0],u[1]=r[1],u[2]=r[2],u[3]=r[3],u[4]=r[4],u[5]=r[5],u[6]=r[6],u[7]=r[7],u[8]=r[8],u[9]=r[9],u[10]=r[10],u[11]=r[11],u[12]=r[12],u[13]=r[13],u[14]=r[14],u[15]=r[15]},H=function(){var r=new Float32Array(16),u=new Float32Array(16),g=new Float32Array(16);return Ct(r),{data:r,asCSS:function(){for(var c="matrix3d(",w=0;w<15;++w)Math.abs(r[w])<1e-4?c+="0,":c+=r[w].toFixed(10)+",";return Math.abs(r[15])<1e-4?c+="0)":c+=r[15].toFixed(10)+")",c},clear:function(){Ct(r)},translate:function(c,w,S){return _t(r,u),J(g,c,w,S),Q(u,g,r),this},rotateX:function(c){return _t(r,u),$(g,c),Q(u,g,r),this},rotateY:function(c){return _t(r,u),K(g,c),Q(u,g,r),this},rotateZ:function(c){return _t(r,u),A(g,c),Q(u,g,r),this},scale:function(c,w){return _t(r,u),te(g,c,w),Q(u,g,r),this},skew:function(c,w){return _t(r,u),vt(g,c,w),Q(u,g,r),this}}},Q=function(r,u,g){return g[0]=r[0]*u[0]+r[1]*u[4]+r[2]*u[8]+r[3]*u[12],g[1]=r[0]*u[1]+r[1]*u[5]+r[2]*u[9]+r[3]*u[13],g[2]=r[0]*u[2]+r[1]*u[6]+r[2]*u[10]+r[3]*u[14],g[3]=r[0]*u[3]+r[1]*u[7]+r[2]*u[11]+r[3]*u[15],g[4]=r[4]*u[0]+r[5]*u[4]+r[6]*u[8]+r[7]*u[12],g[5]=r[4]*u[1]+r[5]*u[5]+r[6]*u[9]+r[7]*u[13],g[6]=r[4]*u[2]+r[5]*u[6]+r[6]*u[10]+r[7]*u[14],g[7]=r[4]*u[3]+r[5]*u[7]+r[6]*u[11]+r[7]*u[15],g[8]=r[8]*u[0]+r[9]*u[4]+r[10]*u[8]+r[11]*u[12],g[9]=r[8]*u[1]+r[9]*u[5]+r[10]*u[9]+r[11]*u[13],g[10]=r[8]*u[2]+r[9]*u[6]+r[10]*u[10]+r[11]*u[14],g[11]=r[8]*u[3]+r[9]*u[7]+r[10]*u[11]+r[11]*u[15],g[12]=r[12]*u[0]+r[13]*u[4]+r[14]*u[8]+r[15]*u[12],g[13]=r[12]*u[1]+r[13]*u[5]+r[14]*u[9]+r[15]*u[13],g[14]=r[12]*u[2]+r[13]*u[6]+r[14]*u[10]+r[15]*u[14],g[15]=r[12]*u[3]+r[13]*u[7]+r[14]*u[11]+r[15]*u[15],g},lt=function(r){var u=H(),g={opacity:void 0,width:void 0,height:void 0};return{position:r.position,rotation:r.rotation,rotationPost:r.rotationPost,skew:r.skew,scale:r.scale,scalePost:r.scalePost,opacity:r.opacity,width:r.width,height:r.height,clone:function(){return lt({position:this.position?this.position.slice(0):void 0,rotation:this.rotation?this.rotation.slice(0):void 0,rotationPost:this.rotationPost?this.rotationPost.slice(0):void 0,skew:this.skew?this.skew.slice(0):void 0,scale:this.scale?this.scale.slice(0):void 0,scalePost:this.scalePost?this.scalePost.slice(0):void 0,height:this.height,width:this.width,opacity:this.opacity})},asMatrix:function(){var c=u;return c.clear(),this.transformOrigin&&c.translate(-this.transformOrigin[0],-this.transformOrigin[1],-this.transformOrigin[2]),this.scale&&c.scale(this.scale[0],this.scale[1]),this.skew&&c.skew(this.skew[0],this.skew[1]),this.rotation&&(c.rotateX(this.rotation[0]),c.rotateY(this.rotation[1]),c.rotateZ(this.rotation[2])),this.position&&c.translate(this.position[0],this.position[1],this.position[2]),this.rotationPost&&(c.rotateX(this.rotationPost[0]),c.rotateY(this.rotationPost[1]),c.rotateZ(this.rotationPost[2])),this.scalePost&&c.scale(this.scalePost[0],this.scalePost[1]),this.transformOrigin&&c.translate(this.transformOrigin[0],this.transformOrigin[1],this.transformOrigin[2]),c},getProperties:function(){return g.opacity=this.opacity,g.width=this.width+"px",g.height=this.height+"px",g}}},O=function(r,u,g){var c=r,w=u,S=g,T=w.position!==void 0,R=w.rotation!==void 0,P=w.rotationPost!==void 0,I=w.scale!==void 0,D=w.skew!==void 0,tt=w.width!==void 0,et=w.height!==void 0,bt=w.opacity!==void 0;return{tween:function(N){if(T){var xt=w.position[0]-c.position[0],kt=w.position[1]-c.position[1],X=w.position[2]-c.position[2];S.position[0]=c.position[0]+N*xt,S.position[1]=c.position[1]+N*kt,S.position[2]=c.position[2]+N*X}if(R){var pt=w.rotation[0]-c.rotation[0],ie=w.rotation[1]-c.rotation[1],ne=w.rotation[2]-c.rotation[2];S.rotation[0]=c.rotation[0]+N*pt,S.rotation[1]=c.rotation[1]+N*ie,S.rotation[2]=c.rotation[2]+N*ne}if(P){var di=w.rotationPost[0]-c.rotationPost[0],ci=w.rotationPost[1]-c.rotationPost[1],vi=w.rotationPost[2]-c.rotationPost[2];S.rotationPost[0]=c.rotationPost[0]+N*di,S.rotationPost[1]=c.rotationPost[1]+N*ci,S.rotationPost[2]=c.rotationPost[2]+N*vi}if(D){var _i=w.scale[0]-c.scale[0],gi=w.scale[1]-c.scale[1];S.scale[0]=c.scale[0]+N*_i,S.scale[1]=c.scale[1]+N*gi}if(I){var mi=w.skew[0]-c.skew[0],yi=w.skew[1]-c.skew[1];S.skew[0]=c.skew[0]+N*mi,S.skew[1]=c.skew[1]+N*yi}if(tt){var wi=w.width-c.width;S.width=c.width+N*wi}if(et){var Si=w.height-c.height;S.height=c.height+N*Si}if(bt){var bi=w.opacity-c.opacity;S.opacity=c.opacity+N*bi}},asMatrix:function(){return S.asMatrix()},getProperties:function(){return S.getProperties()},setReverse:function(){var N=c;c=w,w=N}}},Ht=function(r,u,g,c){var w=r(0,H()),S=u,T=g,R=c,P=!1;return{tween:function(I){P&&(I=1-I),w.clear(),w=r(I,w);var D=T.width-S.width,tt=T.height-S.height,et=T.opacity-S.opacity;T.width!==void 0&&(R.width=S.width+I*D),T.height!==void 0&&(R.height=S.height+I*tt),T.opacity!==void 0&&(R.opacity=S.opacity+I*et)},asMatrix:function(){return w},getProperties:function(){return R.getProperties()},setReverse:function(){P=!0}}},M=function(r,u){return typeof r>"u"?u:r},j=function(r,u,g){var c="";g&&(c="perspective("+g+"px) ");var w=u.asCSS();r.style[i]=c+w},ft=function(r,u){for(var g in u)r.style[g]=u[g]},Y=function(r){return typeof r=="function"},ee=function(r){if(!r)return r;var u={};for(var g in r)u[g]=r[g];return u};return a.createMatrix=H,a.setElementTransform=j,a})(),Et=(function(){var h=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],n=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function t(a,s,f,l,v){if(typeof a=="string")a=document.getElementById(a);else if(!a instanceof HTMLCanvasElement)return;var p=a.getContext("2d"),d;try{try{d=p.getImageData(s,f,l,v)}catch(y){throw new Error("unable to access local image data: "+y)}}catch(y){throw new Error("unable to access image data: "+y)}return d}function i(a,s,f,l,v,p){if(!(isNaN(p)||p<1)){p|=0;var d=t(a,s,f,l,v);d=e(d,s,f,l,v,p),a.getContext("2d").putImageData(d,s,f)}}function e(a,s,f,l,v,p){var d=a.data,y,E,m,_,k,C,U,z,L,W,q,Z,V,dt,ct,st,at,ht,ut,J,$,K,A,vt,te=p+p+1,Ct=l-1,_t=v-1,H=p+1,Q=H*(H+1)/2,lt=new o,O=lt;for(m=1;m<te;m++)if(O=O.next=new o,m==H)var Ht=O;O.next=lt;var M=null,j=null;U=C=0;var ft=h[p],Y=n[p];for(E=0;E<v;E++){for(st=at=ht=ut=z=L=W=q=0,Z=H*(J=d[C]),V=H*($=d[C+1]),dt=H*(K=d[C+2]),ct=H*(A=d[C+3]),z+=Q*J,L+=Q*$,W+=Q*K,q+=Q*A,O=lt,m=0;m<H;m++)O.r=J,O.g=$,O.b=K,O.a=A,O=O.next;for(m=1;m<H;m++)_=C+((Ct<m?Ct:m)<<2),z+=(O.r=J=d[_])*(vt=H-m),L+=(O.g=$=d[_+1])*vt,W+=(O.b=K=d[_+2])*vt,q+=(O.a=A=d[_+3])*vt,st+=J,at+=$,ht+=K,ut+=A,O=O.next;for(M=lt,j=Ht,y=0;y<l;y++)d[C+3]=A=q*ft>>Y,A!=0?(A=255/A,d[C]=(z*ft>>Y)*A,d[C+1]=(L*ft>>Y)*A,d[C+2]=(W*ft>>Y)*A):d[C]=d[C+1]=d[C+2]=0,z-=Z,L-=V,W-=dt,q-=ct,Z-=M.r,V-=M.g,dt-=M.b,ct-=M.a,_=U+((_=y+p+1)<Ct?_:Ct)<<2,st+=M.r=d[_],at+=M.g=d[_+1],ht+=M.b=d[_+2],ut+=M.a=d[_+3],z+=st,L+=at,W+=ht,q+=ut,M=M.next,Z+=J=j.r,V+=$=j.g,dt+=K=j.b,ct+=A=j.a,st-=J,at-=$,ht-=K,ut-=A,j=j.next,C+=4;U+=l}for(y=0;y<l;y++){for(at=ht=ut=st=L=W=q=z=0,C=y<<2,Z=H*(J=d[C]),V=H*($=d[C+1]),dt=H*(K=d[C+2]),ct=H*(A=d[C+3]),z+=Q*J,L+=Q*$,W+=Q*K,q+=Q*A,O=lt,m=0;m<H;m++)O.r=J,O.g=$,O.b=K,O.a=A,O=O.next;for(k=l,m=1;m<=p;m++)C=k+y<<2,z+=(O.r=J=d[C])*(vt=H-m),L+=(O.g=$=d[C+1])*vt,W+=(O.b=K=d[C+2])*vt,q+=(O.a=A=d[C+3])*vt,st+=J,at+=$,ht+=K,ut+=A,O=O.next,m<_t&&(k+=l);for(C=y,M=lt,j=Ht,E=0;E<v;E++)_=C<<2,d[_+3]=A=q*ft>>Y,A>0?(A=255/A,d[_]=(z*ft>>Y)*A,d[_+1]=(L*ft>>Y)*A,d[_+2]=(W*ft>>Y)*A):d[_]=d[_+1]=d[_+2]=0,z-=Z,L-=V,W-=dt,q-=ct,Z-=M.r,V-=M.g,dt-=M.b,ct-=M.a,_=y+((_=E+H)<_t?_:_t)*l<<2,z+=st+=M.r=d[_],L+=at+=M.g=d[_+1],W+=ht+=M.b=d[_+2],q+=ut+=M.a=d[_+3],M=M.next,Z+=J=j.r,V+=$=j.g,dt+=K=j.b,ct+=A=j.a,st-=J,at-=$,ht-=K,ut-=A,j=j.next,C+=l}return a}function o(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}return i})();HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(h,n,t){for(var i=atob(this.toDataURL(n,t).split(",")[1]),e=i.length,o=new Uint8Array(e),a=0;a<e;a++)o[a]=i.charCodeAt(a);h(new Blob([o],{type:n||"image/png"}))}});var Tt=(function(){function h(n,t){for(var i=0;i<t.length;i++){var e=t[i];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(n,e.key,e)}}return function(n,t,i){return t&&h(n.prototype,t),i&&h(n,i),n}})(),Ot=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h};function Rt(h,n){if(!(h instanceof n))throw new TypeError("Cannot call a class as a function")}var Te=function(n){if(typeof n.dataset>"u"){var t={},i,e,o=n.attributes;for(i in o)o.hasOwnProperty(i)&&o[i].name&&/^data-[a-z_\-\d]*$/i.test(o[i].name)&&(e=Re(o[i].name.substr(5)),t[e]=o[i].value);return t}return n.dataset},Re=function(n){return n.replace(/\-./g,function(t){return t.charAt(1).toUpperCase()})},re=function(n){for(var t=[],i=Array.prototype.slice.call(n.attributes),e=i.length,o=0;o<e;o++)t.push({name:i[o].name,value:i[o].value});return t},Gt=function(n){return{x:typeof n.offsetX>"u"?n.layerX:n.offsetX,y:typeof n.offsetY>"u"?n.layerY:n.offsetY}},ae=function(n,t){var i,e={},o=t||{};for(i in n)n.hasOwnProperty(i)&&(e[i]=typeof o[i]>"u"?n[i]:o[i]);return e},oe={ESC:27,RETURN:13},wt={DOWN:["touchstart","pointerdown","mousedown"],MOVE:["touchmove","pointermove","mousemove"],UP:["touchend","touchcancel","pointerup","mouseup"]},ot={jpeg:"image/jpeg",jpg:"image/jpeg",jpe:"image/jpeg",png:"image/png",gif:"image/gif",bmp:"image/bmp"},Pe=/(\.png|\.bmp|\.gif|\.jpg|\.jpe|\.jpg|\.jpeg)$/,F=function(n,t){var i=document.createElement(n);return t&&(i.className=t),i},jt=function(n,t,i){t.forEach(function(e){n.addEventListener(e,i,!1)})},Pt=function(n,t,i){t.forEach(function(e){n.removeEventListener(e,i,!1)})},Ie=function(n){var t=n.changedTouches?n.changedTouches[0]:n;if(t)return{x:t.pageX,y:t.pageY}},Me=function(n,t){var i=.5,e=.5,o=Math.PI/180*t,a=Math.cos(o),s=Math.sin(o),f=n.x,l=n.y,v=n.x+n.width,p=n.y+n.height,d=a*(f-i)+s*(l-e)+i,y=a*(l-e)-s*(f-i)+e,E=a*(v-i)+s*(p-e)+i,m=a*(p-e)-s*(v-i)+e;d<=E?(n.x=d,n.width=E-d):(n.x=E,n.width=d-E),y<=m?(n.y=y,n.height=m-y):(n.y=m,n.height=y-m)},se=function(n){var t=Ie(n);return t.x-=window.pageXOffset||document.documentElement.scrollLeft,t.y-=window.pageYOffset||document.documentElement.scrollTop,t},De=function(n){return n.charAt(0).toLowerCase()+n.slice(1)},zt=function(n){return n.charAt(0).toUpperCase()+n.slice(1)},he=function(n){return n[n.length-1]},G=function(n,t,i){return Math.max(t,Math.min(i,n))},St=function(n,t){if(!t)return!1;for(var i=0;i<t.length;i++)if(t[i]===n)return!0;return!1},Le=function(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"POST",i=arguments[2],e=arguments[3],o=arguments[4],a=arguments[5],s=arguments[6],f=new XMLHttpRequest;o&&f.upload.addEventListener("progress",function(l){o(l.loaded,l.total)}),f.open(t,n,!0),e&&e(f,i),f.onreadystatechange=function(){if(f.readyState===4&&f.status>=200&&f.status<300){var l=f.responseText;if(!l.length){a();return}if(l.indexOf("Content-Length")!==-1){s("file-too-big");return}var v=void 0;try{v=JSON.parse(f.responseText)}catch{}if((typeof v>"u"?"undefined":Ot(v))==="object"&&v.status==="failure"){s(v.message);return}a(v||l)}else if(f.readyState===4){var p=void 0;try{p=JSON.parse(f.responseText)}catch{}if((typeof p>"u"?"undefined":Ot(p))==="object"&&p.status==="failure"){s(p.message);return}s("fail")}},f.send(i)},nt=function(n){n&&(n.style.webkitTransform="",n.style.transform="")},Oe=function(n){return n/1e6},ze=function(){var n=[],t=void 0,i=void 0;for(t in ot)ot.hasOwnProperty(t)&&(i=ot[t],n.indexOf(i)==-1&&n.push(i));return n},Ae=function(n){return n==="image/jpeg"},At=function(n){var t=void 0;for(t in ot)if(ot.hasOwnProperty(t)&&ot[t]===n)return t;return n},Fe=function(n){var t=void 0;for(t in ot)if(ot.hasOwnProperty(t)&&n.indexOf(ot[t])!==-1)return ot[t];return null},ue=function(n){return n.split("/").pop().split("?").shift()},It=function(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return(t+n).slice(-t.length)},Xt=function(n){return n.getFullYear()+"-"+It(n.getMonth()+1,"00")+"-"+It(n.getDate(),"00")+"_"+It(n.getHours(),"00")+"-"+It(n.getMinutes(),"00")+"-"+It(n.getSeconds(),"00")},Be=function(n){return typeof n.name>"u"?Xt(new Date)+"."+At(le(n)):n.name},le=function(n){return n.type||"image/jpeg"},Ft=function(n){if(typeof n!="string")return Xt(new Date);var t=ue(n);return t.split(".").shift()},Yt=function(n,t){try{return new File([n],t,{type:n.type,lastModified:Date.now()})}catch{return n.lastModified=new Date,n.name=t,n}},fe=function(n){return/^data:image/.test(n)},Ue=function(n,t,i,e,o,a){n=""+n+(n.indexOf("?")!==-1?"&":"?")+"url="+e;var s=new XMLHttpRequest;s.open("GET",n,!0),t(s),s.responseType="json",s.onload=function(){if(this.response.status==="failure"){o(this.response.message);return}pe(this.response.body,i,a)},s.send()},pe=function(n,t,i,e){var o=new XMLHttpRequest;o.open("GET",n,!0),t(o),o.responseType="blob",o.onload=function(a){if(o.status>=200&&o.status<300){var s=ue(n),f=Fe(this.response.type);Pe.test(s)||(s+="."+At(f));var l=Yt(this.response,s);i(ce(l,f))}else e(o.status+": "+o.statusText)},o.onerror=function(){e()},o.send()},He=function(n){var t=n.split(",")[1],i=t.replace(/\s/g,"");return atob(i)},Jt=function(n,t){for(var i=He(n),e=new ArrayBuffer(i.length),o=new Uint8Array(e),a=0;a<i.length;a++)o[a]=i.charCodeAt(a);var s=$t(n);return typeof t>"u"&&(t=Xt(new Date)+"."+At(s)),Yt(Ne(e,s),t)},Ne=function(n,t){var i=window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;if(i){var e=new i;return e.append(n),e.getBlob(t)}return new Blob([n],{type:t})},We=function(n,t,i){var e=typeof n=="string"?n.indexOf("data:image")!==0:!0;b.parseMetaData(n,function(o){var a={canvas:!0,crossOrigin:e};t&&(a.maxWidth=t.width,a.maxHeight=t.height),o.exif&&(a.orientation=o.exif.get("Orientation")),b(n,function(s){if(s.type==="error"){i();return}i(s,o)},a)})},Mt=function(n,t,i){var e,o,a,s,f=t/n;return f<i?(s=t,a=s/i,e=(n-a)*.5,o=0):(a=n,s=a*i,e=0,o=(t-s)*.5),{x:e,y:o,height:s,width:a}},qe=function(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments[2],e=F("canvas"),o=t.rotation,a=t.crop,s=t.size,f=t.filters,l=t.minSize;if(a){var v=o%180!==0,p={width:v?n.height:n.width,height:v?n.width:n.height};a.x<0&&(a.x=0),a.y<0&&(a.y=0),a.width>p.width&&(a.width=p.width),a.height>p.height&&(a.height=p.height),a.y+a.height>p.height&&(a.y=Math.max(0,p.height-a.height)),a.x+a.width>p.width&&(a.x=Math.max(0,p.width-a.width));var d=a.x/p.width,y=a.y/p.height,E=a.width/p.width,m=a.height/p.height;e.width=a.width,e.height=a.height;var _=e.getContext("2d");o===90?(_.translate(e.width*.5,e.height*.5),_.rotate(-90*Math.PI/180),_.drawImage(n,(1-y)*n.width-n.width*m,a.x,a.height,a.width,-e.height*.5,-e.width*.5,e.height,e.width)):o===180?(_.translate(e.width*.5,e.height*.5),_.rotate(-180*Math.PI/180),_.drawImage(n,(1-(d+E))*p.width,(1-(y+m))*p.height,E*p.width,m*p.height,-e.width*.5,-e.height*.5,e.width,e.height)):o===270?(_.translate(e.width*.5,e.height*.5),_.rotate(-270*Math.PI/180),_.drawImage(n,a.y,(1-d)*n.height-n.height*E,a.height,a.width,-e.height*.5,-e.width*.5,e.height,e.width)):_.drawImage(n,a.x,a.y,a.width,a.height,0,0,e.width,e.height)}if(s){var k=s.width/e.width,C=s.height/e.height,U=Math.min(k,C);de(e,U,s,l),f.sharpen>0&&je(e,Ye(f.sharpen))}i(e)};function de(h,n,t,i){if(!(n>=1)){for(var e=h.width,o=h.height,a=Math.max(i.width,Math.min(t.width,Math.round(h.width*n))),s=Math.max(i.height,Math.min(t.height,Math.round(h.height*n))),f=Bt(h),l=void 0,v=void 0;e>a&&o>s;)l=document.createElement("canvas"),e=Math.round(f.width*.5),o=Math.round(f.height*.5),e<a&&(e=a),o<s&&(o=s),l.width=e,l.height=o,v=l.getContext("2d"),v.drawImage(f,0,0,e,o),f=Bt(l);h.width=a,h.height=s,v=h.getContext("2d"),v.drawImage(f,0,0,a,s)}}var Ge=function(n){var t=n.getContext("2d");return t.getImageData(0,0,n.width,n.height)},je=function(n,t){var i=n.getContext("2d");i.putImageData(t(Ge(n),n.width,n.height),0,0)},Xe=function(n,t,i){var e=document.createElement("canvas");e.width=n,e.height=t;var o=e.getContext("2d"),a=o.createImageData(e.width,e.height);return a},Ye=function(n){return function(t,i,e){for(var o=[0,-1,0,-1,5,-1,0,-1,0],a=Math.round(Math.sqrt(o.length)),s=a*.5|0,f=Xe(i,e),l=f.data,v=t.data,p=e,d=void 0;p--;)for(d=i;d--;){for(var y=p,E=d,m=(p*i+d)*4,_=0,k=0,C=0,U=0,z=0;z<a;z++)for(var L=0;L<a;L++){var W=y+z-s,q=E+L-s;if(W>=0&&W<e&&q>=0&&q<i){var Z=(W*i+q)*4,V=o[z*a+L];_+=v[Z]*V,k+=v[Z+1]*V,C+=v[Z+2]*V,U+=v[Z+3]*V}}l[m]=_*n+v[m]*(1-n),l[m+1]=k*n+v[m+1]*(1-n),l[m+2]=C*n+v[m+2]*(1-n),l[m+3]=v[m+3]}return f}},Je=function(n,t){var i=Math.abs(n.width-t.width),e=Math.abs(n.height-t.height);return Math.max(i,e)},Bt=function(n){return Dt(n,1)},Dt=function(n,t){if(!n)return null;var i=document.createElement("canvas"),e=i.getContext("2d");return i.width=n.width,i.height=n.height,e.drawImage(n,0,0),t>0&&t!==1&&de(i,t,{width:Math.round(n.width*t),height:Math.round(n.height*t)},{width:0,height:0}),i},$e=function(n){return n.width&&n.height},Ke=function(n,t){var i=t.getContext("2d");$e(t)?i.drawImage(n,0,0,t.width,t.height):(t.width=n.width,t.height=n.height,i.drawImage(n,0,0))},Ze=function(n){Et(n,0,0,n.width,n.height,3)},Ve=function(n,t){return parseInt(n.width,10)>=t.width&&parseInt(n.height,10)>=t.height},Qe=function(n,t,i){return{x:n.x*t,y:n.y*i,width:n.width*t,height:n.height*i}},ti=function(n,t,i){return{x:n.x/t,y:n.y/i,width:n.width/t,height:n.height/i}},ei=function(n){if(!(!n||n.value==="")){try{n.value=""}catch{}if(n.value){var t=document.createElement("form"),i=n.parentNode,e=n.nextSibling;t.appendChild(n),t.reset(),e?i.insertBefore(n,e):i.appendChild(n)}}},it=function(n){return(typeof value>"u"?"undefined":Ot(value))==="object"&&value!==null?JSON.parse(JSON.stringify(n)):n},ce=function(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!n)return null;var i=n.slice(0,n.size,t||n.type);return i.name=n.name,i.lastModified=new Date(n.lastModified),i},ii=function(n){var t=it(n);return t.input.file=ce(n.input.file),t.output.image=Bt(n.output.image),t},ve=function(n,t,i){return!n||!t?null:n.toDataURL(t,Ae(t)&&typeof i=="number"?i/100:void 0)},$t=function(n){if(!n)return null;var t=n.substr(0,16).match(/^.+;/);return t.length?t[0].substring(5,t[0].length-1):null},ni=function(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments[2],e=arguments[3],o=arguments[4],a={server:it(n.server),meta:it(n.meta),input:{name:n.input.name,type:n.input.type,size:n.input.size,width:n.input.width,height:n.input.height,field:n.input.field}};return St("input",t)&&!o&&(a.input.image=ve(n.input.image,n.input.type)),St("output",t)&&(a.output={name:e?Ft(n.input.name)+"."+e:n.input.name,type:ot[e]||n.input.type,width:n.output.width,height:n.output.height},a.output.image=ve(n.output.image,a.output.type,i),a.output.type=$t(a.output.image),a.output.type==="image/png"&&(a.output.name=Ft(a.input.name)+".png")),St("actions",t)&&(a.actions=it(n.actions)),a},ri=function(n,t,i){var e=n.output.image,o=i?Ft(n.input.name)+"."+i:n.input.name,a=ot[i]||n.input.type;a==="image/png"&&(o=Ft(n.input.name)+".png"),e.toBlob(function(s){if("msSaveBlob"in window.navigator){window.navigator.msSaveBlob(s,o);return}var f=(window.URL||window.webkitURL).createObjectURL(s),l=F("a");l.style.display="none",l.download=o,l.href=f,document.body.appendChild(l),l.click(),setTimeout(function(){document.body.removeChild(l),(window.URL||window.webkitURL).revokeObjectURL(f)},0)},a,typeof t=="number"?t/100:void 0)},ai=function(n,t,i){var e=i.querySelector(n);e&&(e.style.display=t?"":"none")},_e=function(n){return Array.prototype.slice.call(n)},Kt=function(n){n.parentNode.removeChild(n)},oi=function(n){var t=F("div");return n.parentNode&&(n.nextSibling?n.parentNode.insertBefore(t,n.nextSibling):n.parentNode.appendChild(t)),t.appendChild(n),t},ge=function(n,t,i,e){var o=(e-90)*Math.PI/180;return{x:n+i*Math.cos(o),y:t+i*Math.sin(o)}},si=function(n,t,i,e,o){var a=ge(n,t,i,o),s=ge(n,t,i,e),f=o-e<=180?"0":"1",l=["M",a.x,a.y,"A",i,i,0,f,0,s.x,s.y].join(" ");return l},me=function(n,t,i,e){return si(n,t,i,0,e*360)},hi=(function(){var h={n:function(t,i,e,o){var a,s,f,l,v,p,d,y;return f=t.y+t.height,a=G(i.y,0,f),f-a<e.min.height&&(a=f-e.min.height),v=o?(f-a)/o:t.width,v<e.min.width&&(v=e.min.width,a=f-v*o),d=(v-t.width)*.5,l=t.x-d,s=t.x+t.width+d,(l<0||Math.round(s)>Math.round(e.width))&&(y=Math.min(t.x,e.width-(t.x+t.width)),l=t.x-y,s=t.x+t.width+y,v=s-l,p=v*o,a=f-p),{x:l,y:a,width:s-l,height:f-a}},s:function(t,i,e,o){var a,s,f,l,v,p,d,y;return a=t.y,f=G(i.y,a,e.height),f-a<e.min.height&&(f=a+e.min.height),v=o?(f-a)/o:t.width,v<e.min.width&&(v=e.min.width,f=a+v*o),d=(v-t.width)*.5,l=t.x-d,s=t.x+t.width+d,(l<0||Math.round(s)>Math.round(e.width))&&(y=Math.min(t.x,e.width-(t.x+t.width)),l=t.x-y,s=t.x+t.width+y,v=s-l,p=v*o,f=a+p),{x:l,y:a,width:s-l,height:f-a}},e:function(t,i,e,o){var a,s,f,l,v,p,d,y;return l=t.x,s=G(i.x,l,e.width),s-l<e.min.width&&(s=l+e.min.width),p=o?(s-l)*o:t.height,p<e.min.height&&(p=e.min.height,s=l+p/o),d=(p-t.height)*.5,a=t.y-d,f=t.y+t.height+d,(a<0||Math.round(f)>Math.round(e.height))&&(y=Math.min(t.y,e.height-(t.y+t.height)),a=t.y-y,f=t.y+t.height+y,p=f-a,v=p/o,s=l+v),{x:l,y:a,width:s-l,height:f-a}},w:function(t,i,e,o){var a,s,f,l,v,p,d,y;return s=t.x+t.width,l=G(i.x,0,s),s-l<e.min.width&&(l=s-e.min.width),p=o?(s-l)*o:t.height,p<e.min.height&&(p=e.min.height,l=s-p/o),d=(p-t.height)*.5,a=t.y-d,f=t.y+t.height+d,(a<0||Math.round(f)>Math.round(e.height))&&(y=Math.min(t.y,e.height-(t.y+t.height)),a=t.y-y,f=t.y+t.height+y,p=f-a,v=p/o,l=s-v),{x:l,y:a,width:s-l,height:f-a}},ne:function(t,i,e,o){var a,s,f,l,v,p,d;return l=t.x,f=t.y+t.height,s=G(i.x,l,e.width),s-l<e.min.width&&(s=l+e.min.width),p=o?(s-l)*o:G(f-i.y,e.min.height,f),p<e.min.height&&(p=e.min.height,s=l+p/o),a=t.y-(p-t.height),(a<0||Math.round(f)>Math.round(e.height))&&(d=Math.min(t.y,e.height-(t.y+t.height)),a=t.y-d,p=f-a,v=p/o,s=l+v),{x:l,y:a,width:s-l,height:f-a}},se:function(t,i,e,o){var a,s,f,l,v,p,d;return l=t.x,a=t.y,s=G(i.x,l,e.width),s-l<e.min.width&&(s=l+e.min.width),p=o?(s-l)*o:G(i.y-t.y,e.min.height,e.height-a),p<e.min.height&&(p=e.min.height,s=l+p/o),f=t.y+t.height+(p-t.height),(a<0||Math.round(f)>Math.round(e.height))&&(d=Math.min(t.y,e.height-(t.y+t.height)),f=t.y+t.height+d,p=f-a,v=p/o,s=l+v),{x:l,y:a,width:s-l,height:f-a}},sw:function(t,i,e,o){var a,s,f,l,v,p,d;return s=t.x+t.width,a=t.y,l=G(i.x,0,s),s-l<e.min.width&&(l=s-e.min.width),p=o?(s-l)*o:G(i.y-t.y,e.min.height,e.height-a),p<e.min.height&&(p=e.min.height,l=s-p/o),f=t.y+t.height+(p-t.height),(a<0||Math.round(f)>Math.round(e.height))&&(d=Math.min(t.y,e.height-(t.y+t.height)),f=t.y+t.height+d,p=f-a,v=p/o,l=s-v),{x:l,y:a,width:s-l,height:f-a}},nw:function(t,i,e,o){var a,s,f,l,v,p,d;return s=t.x+t.width,f=t.y+t.height,l=G(i.x,0,s),s-l<e.min.width&&(l=s-e.min.width),p=o?(s-l)*o:G(f-i.y,e.min.height,f),p<e.min.height&&(p=e.min.height,l=s-p/o),a=t.y-(p-t.height),(a<0||Math.round(f)>Math.round(e.height))&&(d=Math.min(t.y,e.height-(t.y+t.height)),a=t.y-d,p=f-a,v=p/o,l=s-v),{x:l,y:a,width:s-l,height:f-a}}};return(function(){function n(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document.createElement("div");Rt(this,n),this._element=t,this._interaction=null,this._minWidth=1,this._minHeight=1,this._ratio=null,this._rect={x:0,y:0,width:0,height:0},this._space={width:0,height:0},this._rectChanged=!1,this._init()}return Tt(n,[{key:"_init",value:function(){this._element.className="slim-crop-area";var i=F("div","grid");this._element.appendChild(i);for(var e in h)if(h.hasOwnProperty(e)){var o=F("button",e);this._element.appendChild(o)}var a=F("button","c");this._element.appendChild(a),jt(document,wt.DOWN,this)}},{key:"reset",value:function(){this._interaction=null,this._rect={x:0,y:0,width:0,height:0},this._rectChanged=!0,this._redraw(),this._element.dispatchEvent(new CustomEvent("change"))}},{key:"rescale",value:function(i){i!==1&&(this._interaction=null,this._rectChanged=!0,this._rect.x*=i,this._rect.y*=i,this._rect.width*=i,this._rect.height*=i,this._redraw(),this._element.dispatchEvent(new CustomEvent("change")))}},{key:"limit",value:function(i,e){this._space.width=i,this._space.height=e}},{key:"offset",value:function(i,e){this._space.x=i,this._space.y=e}},{key:"resize",value:function(i,e,o,a){this._interaction=null,this._rect={x:G(i,0,this._space.width-this._minWidth),y:G(e,0,this._space.height-this._minHeight),width:G(o,this._minWidth,this._space.width),height:G(a,this._minHeight,this._space.height)},this._rectChanged=!0,this._redraw(),this._element.dispatchEvent(new CustomEvent("change"))}},{key:"handleEvent",value:function(i){switch(i.type){case"touchstart":case"pointerdown":case"mousedown":this._onStartDrag(i);break;case"touchmove":case"pointermove":case"mousemove":this._onDrag(i);break;case"touchend":case"touchcancel":case"pointerup":case"mouseup":this._onStopDrag(i)}}},{key:"_onStartDrag",value:function(i){this._element.contains(i.target)&&(i.preventDefault(),jt(document,wt.MOVE,this),jt(document,wt.UP,this),this._interaction={type:i.target.className,offset:se(i)},this._interaction.offset.x-=this._rect.x,this._interaction.offset.y-=this._rect.y,this._element.setAttribute("data-dragging","true"),this._redraw())}},{key:"_onDrag",value:function(i){i.preventDefault();var e=se(i),o=this._interaction.type;o==="c"?(this._rect.x=G(e.x-this._interaction.offset.x,0,this._space.width-this._rect.width),this._rect.y=G(e.y-this._interaction.offset.y,0,this._space.height-this._rect.height)):h[o]&&(this._rect=h[o](this._rect,{x:e.x-this._space.x,y:e.y-this._space.y},{x:0,y:0,width:this._space.width,height:this._space.height,min:{width:this._minWidth,height:this._minHeight}},this._ratio)),this._rectChanged=!0,this._element.dispatchEvent(new CustomEvent("input"))}},{key:"_onStopDrag",value:function(i){i.preventDefault(),Pt(document,wt.MOVE,this),Pt(document,wt.UP,this),this._interaction=null,this._element.setAttribute("data-dragging","false"),this._element.dispatchEvent(new CustomEvent("change"))}},{key:"_redraw",value:function(){var i=this;if(this._rectChanged){var e="translate("+this._rect.x+"px,"+this._rect.y+"px);";this._element.style.cssText=`
					-webkit-transform: `+e+`;
					transform: `+e+`;
					width:`+this._rect.width+`px;
					height:`+this._rect.height+`px;
				`,this._rectChanged=!1}this._interaction&&requestAnimationFrame(function(){return i._redraw()})}},{key:"destroy",value:function(){this._interaction=!1,this._rectChanged=!1,Pt(document,wt.DOWN,this),Pt(document,wt.MOVE,this),Pt(document,wt.UP,this),Kt(this._element)}},{key:"element",get:function(){return this._element}},{key:"space",get:function(){return this._space}},{key:"area",get:function(){var i=this._rect.x/this._space.width,e=this._rect.y/this._space.height,o=this._rect.width/this._space.width,a=this._rect.height/this._space.height;return{x:i,y:e,width:o,height:a}}},{key:"dirty",get:function(){return this._rect.x!==0||this._rect.y!==0||this._rect.width!==0||this._rect.height!==0}},{key:"minWidth",set:function(i){this._minWidth=Math.max(i,1)}},{key:"minHeight",set:function(i){this._minHeight=Math.max(i,1)}},{key:"ratio",set:function(i){this._ratio=i}}]),n})()})(),Zt=(function(){var h=["input","change"],n=(function(){function t(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document.createElement("div"),e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Rt(this,t),this._element=i,this._options=ae(t.options(),e),this._ratio=null,this._output=null,this._rotating=!1,this._input=null,this._preview=null,this._previewBlurred=null,this._blurredPreview=!1,this._cropper=null,this._straightCrop=null,this._previewWrapper=null,this._currentWindowSize={},this._btnGroup=null,this._maskFrame=null,this._dirty=!1,this._wrapperRotation=0,this._wrapperScale=1,this._init()}return Tt(t,[{key:"_init",value:function(){var e=this;this._element.className="slim-image-editor",this._container=F("div","slim-container"),this._wrapper=F("div","slim-wrapper"),this._stage=F("div","slim-stage"),this._container.appendChild(this._stage),this._cropper=new hi,h.forEach(function(a){e._cropper.element.addEventListener(a,e)}),this._stage.appendChild(this._cropper.element),this._previewWrapper=F("div","slim-image-editor-preview slim-crop-preview"),this._previewBlurred=F("canvas","slim-crop-blur"),this._previewWrapper.appendChild(this._previewBlurred),this._wrapper.appendChild(this._previewWrapper),this._previewMask=F("div","slim-crop-mask"),this._preview=F("img"),this._previewMask.appendChild(this._preview),this._cropper.element.appendChild(this._previewMask),this._btnGroup=F("div","slim-editor-btn-group"),t.Buttons.forEach(function(a){var s=zt(a),f=e._options["button"+s+"Label"],l=e._options["button"+s+"Title"],v=e._options["button"+s+"ClassName"],p=F("button","slim-editor-btn slim-btn-"+a+(v?" "+v:""));p.innerHTML=f,p.title=l||f,p.type="button",p.setAttribute("data-action",a),p.addEventListener("click",e),e._btnGroup.appendChild(p)}),this._utilsGroup=F("div","slim-editor-utils-group");var o=F("button","slim-editor-utils-btn slim-btn-rotate"+(this._options.buttonRotateClassName?" "+this._options.buttonRotateClassName:""));o.setAttribute("data-action","rotate"),o.addEventListener("click",this),o.title=this._options.buttonRotateTitle,this._utilsGroup.appendChild(o),this._container.appendChild(this._wrapper),this._element.appendChild(this._container),this._element.appendChild(this._utilsGroup),this._element.appendChild(this._btnGroup)}},{key:"dirty",value:function(){this._dirty=!0}},{key:"handleEvent",value:function(e){switch(e.type){case"click":this._onClick(e);break;case"change":this._onGridChange(e);break;case"input":this._onGridInput(e);break;case"keydown":this._onKeyDown(e);break;case"resize":this._onResize(e);break}}},{key:"_onKeyDown",value:function(e){switch(e.keyCode){case oe.RETURN:{this._confirm();break}case oe.ESC:{this._cancel();break}}}},{key:"_onClick",value:function(e){e.target.classList.contains("slim-btn-cancel")&&this._cancel(),e.target.classList.contains("slim-btn-confirm")&&this._confirm(),e.target.classList.contains("slim-btn-rotate")&&this._rotate()}},{key:"_onResize",value:function(){this._currentWindowSize={width:window.innerWidth,height:window.innerHeight},this._redraw(),this._redrawCropper(this._cropper.area),this._updateWrapperScale(),this._redrawWrapper()}},{key:"_redrawWrapper",value:function(){var e=x.createMatrix();e.scale(this._wrapperScale,this._wrapperScale),e.rotateZ(this._wrapperRotation*(Math.PI/180)),x.setElementTransform(this._previewWrapper,e)}},{key:"_onGridInput",value:function(){this._redrawCropMask()}},{key:"_onGridChange",value:function(){this._redrawCropMask()}},{key:"_updateWrapperRotation",value:function(){this._options.minSize.width>this._input.height||this._options.minSize.height>this._input.width?this._wrapperRotation+=180:this._wrapperRotation+=90}},{key:"_updateWrapperScale",value:function(){var e=this._wrapperRotation%180!==0;if(e){var o=this._container.offsetWidth,a=this._container.offsetHeight,s=this._wrapper.offsetHeight,f=this._wrapper.offsetWidth,l=o/s;l*f>a&&(l=a/f),this._wrapperScale=l}else this._wrapperScale=1}},{key:"_cancel",value:function(){this._rotating||this._element.dispatchEvent(new CustomEvent("cancel"))}},{key:"_confirm",value:function(){if(!this._rotating){var e=this._wrapperRotation%180!==0,o=this._cropper.area,a=Qe(o,e?this._input.height:this._input.width,e?this._input.width:this._input.height);this._element.dispatchEvent(new CustomEvent("confirm",{detail:{rotation:this._wrapperRotation%360,crop:a}}))}}},{key:"_rotate",value:function(){var e=this;if(!this._rotating){this._rotating=!0,this._updateWrapperRotation();var o=this.ratio===1||this._ratio===null?this._cropper.area:null;o&&Me(o,90),this._updateWrapperScale(),this._hideCropper(),x(this._previewWrapper,{rotation:[0,0,this._wrapperRotation*(Math.PI/180)],scale:[this._wrapperScale,this._wrapperScale],easing:"spring",springConstant:.8,springDeceleration:.65,complete:function(){e._redrawCropper(o),e._showCropper(),e._rotating=!1}})}}},{key:"_showCropper",value:function(){x(this._stage,{easing:"ease",duration:250,fromOpacity:0,opacity:1})}},{key:"_hideCropper",value:function(){x(this._stage,{duration:0,fromOpacity:0,opacity:0})}},{key:"_redrawCropMask",value:function(){var e=this,o=this._wrapperRotation%360,a=this._wrapperScale,s={width:this._wrapper.offsetWidth,height:this._wrapper.offsetHeight},f=this._cropper.area,l={x:0,y:0};o===0?(l.x=-f.x,l.y=-f.y):o===90?(l.x=-(1-f.y),l.y=-f.x):o===180?(l.x=-(1-f.x),l.y=-(1-f.y)):o===270&&(l.x=-f.y,l.y=-(1-f.x)),l.x*=s.width,l.y*=s.height,cancelAnimationFrame(this._maskFrame),this._maskFrame=requestAnimationFrame(function(){var v="scale("+a+") rotate("+-o+"deg) translate("+l.x+"px, "+l.y+"px);";e._preview.style.cssText=`
					width: `+e._previewSize.width+`px;
					height: `+e._previewSize.height+`px;
					-webkit-transform: `+v+`;
					transform: `+v+`;
				`})}},{key:"open",value:function(e,o,a,s,f){var l=this;if(this._input&&!this._dirty&&this._ratio===o){f();return}this._currentWindowSize={width:window.innerWidth,height:window.innerHeight},this._dirty=!1,this._wrapperRotation=s||0,this._blurredPreview=!1,this._ratio=o,this._previewSize=null,this._element.style.opacity="0",this._input=e;var v=s%180!==0,p=ti(a,v?e.height:e.width,v?e.width:e.height);this._preview.onload=function(){l._preview.onload=null,l._cropper.ratio=l.ratio,l._redraw(),l._redrawCropper(p),f(),l._element.style.opacity=""},this._preview.src="",this._preview.src=Dt(this._input,Math.min(this._container.offsetWidth/this._input.width,this._container.offsetHeight/this._input.height)*this._options.devicePixelRatio).toDataURL()}},{key:"_redrawCropper",value:function(e){var o=this._wrapperRotation%180!==0,a=o?this._input.height/this._input.width:this._input.width/this._input.height,s=this._wrapper.offsetWidth,f=this._wrapper.offsetHeight,l=this._container.offsetWidth,v=this._container.offsetHeight;this._updateWrapperScale();var p=this._wrapperScale*(o?f:s),d=this._wrapperScale*(o?s:f),y=o?(l-p)*.5:this._wrapper.offsetLeft,E=o?(v-d)*.5:this._wrapper.offsetTop;this._stage.style.cssText=`
				left:`+y+`px;
				top:`+E+`px;
				width:`+p+`px;
				height:`+d+`px;
			`,this._cropper.limit(p,p/a),this._cropper.offset(y+this._element.offsetLeft,E+this._element.offsetTop),this._cropper.minWidth=this._wrapperScale*this._options.minSize.width*this.scalar,this._cropper.minHeight=this._wrapperScale*this._options.minSize.height*this.scalar;var m=null;e?m={x:e.x*p,y:e.y*d,width:e.width*p,height:e.height*d}:m=Mt(p,d,this._ratio||d/p),this._cropper.resize(m.x,m.y,m.width,m.height)}},{key:"_redraw",value:function(){var e=this._input.height/this._input.width,o=this._container.clientWidth,a=this._container.clientHeight,s=o,f=s*e;f>a&&(f=a,s=f/e),s=Math.round(s),f=Math.round(f);var l=(o-s)/2,v=(a-f)/2;this._wrapper.style.cssText=`
				left:`+l+`px;
				top:`+v+`px;
				width:`+s+`px;
				height:`+f+`px;
			`,this._previewBlurred.style.cssText=`
				width:`+s+`px;
				height:`+f+`px;
			`,this._preview.style.cssText=`
				width:`+s+`px;
				height:`+f+`px;
			`,this._previewSize={width:s,height:f},this._blurredPreview||(this._previewBlurred.width=300,this._previewBlurred.height=this._previewBlurred.width*e,Ke(this._input,this._previewBlurred),Ze(this._previewBlurred),this._blurredPreview=!0)}},{key:"show",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){};(this._currentWindowSize.width!==window.innerWidth||this._currentWindowSize.height!==window.innerHeight)&&(this._redraw(),this._redrawCropper(this._cropper.area)),document.addEventListener("keydown",this),window.addEventListener("resize",this);var o=this._wrapperRotation*(Math.PI/180);x(this._previewWrapper,{fromRotation:[0,0,o],rotation:[0,0,o],fromPosition:[0,0,0],position:[0,0,0],fromOpacity:0,opacity:1,fromScale:[this._wrapperScale-.02,this._wrapperScale-.02],scale:[this._wrapperScale,this._wrapperScale],easing:"spring",springConstant:.3,springDeceleration:.85,delay:450,complete:function(){}}),this._cropper.dirty?x(this._stage,{fromPosition:[0,0,0],position:[0,0,0],fromOpacity:0,opacity:1,duration:250,delay:850,complete:function(){nt(this),e()}}):x(this._stage,{fromPosition:[0,0,0],position:[0,0,0],fromOpacity:0,opacity:1,duration:250,delay:1e3,complete:function(){nt(this)}}),x(this._btnGroup.childNodes,{fromScale:[.9,.9],scale:[1,1],fromOpacity:0,opacity:1,delay:function(s){return 1e3+s*100},easing:"spring",springConstant:.3,springDeceleration:.85,complete:function(){nt(this)}}),x(this._utilsGroup.childNodes,{fromScale:[.9,.9],scale:[1,1],fromOpacity:0,opacity:1,easing:"spring",springConstant:.3,springDeceleration:.85,delay:1250,complete:function(){nt(this)}})}},{key:"hide",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){};document.removeEventListener("keydown",this),window.removeEventListener("resize",this),x(this._utilsGroup.childNodes,{fromOpacity:1,opacity:0,duration:250}),x(this._btnGroup.childNodes,{fromOpacity:1,opacity:0,delay:200,duration:350}),x([this._stage,this._previewWrapper],{fromPosition:[0,0,0],position:[0,-250,0],fromOpacity:1,opacity:0,easing:"spring",springConstant:.3,springDeceleration:.75,delay:250,allDone:function(){e()}})}},{key:"destroy",value:function(){var e=this;_e(this._btnGroup.children).forEach(function(o){o.removeEventListener("click",e)}),h.forEach(function(o){e._cropper.element.removeEventListener(o,e)}),this._cropper.destroy(),this._element.parentNode&&Kt(this._element)}},{key:"showRotateButton",set:function(e){e?this._element.classList.remove("slim-rotation-disabled"):this._element.classList.add("slim-rotation-disabled")}},{key:"element",get:function(){return this._element}},{key:"ratio",get:function(){return this._ratio==="input"?this._input.height/this._input.width:this._ratio}},{key:"offset",get:function(){return this._element.getBoundingClientRect()}},{key:"original",get:function(){return this._input}},{key:"scalar",get:function(){return this._previewSize.width/this._input.width}}],[{key:"options",value:function(){return{buttonCancelClassName:null,buttonConfirmClassName:null,buttonCancelLabel:"Cancel",buttonConfirmLabel:"Confirm",buttonCancelTitle:null,buttonConfirmTitle:null,buttonRotateTitle:"Rotate",buttonRotateClassName:null,devicePixelRatio:null,minSize:{width:0,height:0}}}}]),t})();return n.Buttons=["cancel","confirm"],n})(),ui=(function(){var h=["dragenter","dragover","dragleave","drop"];return(function(){function n(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document.createElement("div");Rt(this,n),this._element=t,this._accept=[],this._allowURLs=!1,this._dragPath=null,this._init()}return Tt(n,[{key:"isValidDataTransfer",value:function(i){return i.files&&i.files.length?this.areValidDataTransferFiles(i.files):i.items&&i.items.length?this.areValidDataTransferItems(i.items):null}},{key:"areValidDataTransferFiles",value:function(i){return this._accept.length&&i?this._accept.indexOf(i[0].type)!==-1:!0}},{key:"areValidDataTransferItems",value:function(i){return this._accept.length&&i?this._allowURLs&&i[0].kind==="string"||i[0].type&&i[0].type.indexOf("application")===0?null:this._accept.indexOf(i[0].type)!==-1:!0}},{key:"reset",value:function(){this._element.files=null}},{key:"_init",value:function(){var i=this;this._element.className="slim-file-hopper",h.forEach(function(e){i._element.addEventListener(e,i)})}},{key:"handleEvent",value:function(i){switch(i.type){case"dragenter":case"dragover":this._onDragOver(i);break;case"dragleave":this._onDragLeave(i);break;case"drop":this._onDrop(i);break}}},{key:"_onDrop",value:function(i){i.preventDefault();var e=null;if(this._allowURLs){var o=void 0,a=void 0;try{o=i.dataTransfer.getData("url"),a=i.dataTransfer.getData("text/html")}catch{}if(a&&a.length){var s=a.match(/src\s*=\s*"(.+?)"/);s&&(e=s[1])}else o&&o.length&&(e=o)}if(e)this._element.files=[{remote:e}];else{var f=this.isValidDataTransfer(i.dataTransfer);if(!f){this._element.dispatchEvent(new CustomEvent("file-invalid-drop")),this._dragPath=null;return}this._element.files=i.dataTransfer.files}this._element.dispatchEvent(new CustomEvent("file-drop",{detail:Gt(i)})),this._element.dispatchEvent(new CustomEvent("change")),this._dragPath=null}},{key:"_onDragOver",value:function(i){i.preventDefault(),i.dataTransfer.dropEffect="copy";var e=this.isValidDataTransfer(i.dataTransfer);if(e!==null&&!e){i.dataTransfer.dropEffect="none",this._element.dispatchEvent(new CustomEvent("file-invalid"));return}this._dragPath||(this._dragPath=[]),this._dragPath.push(Gt(i)),this._element.dispatchEvent(new CustomEvent("file-over",{detail:{x:he(this._dragPath).x,y:he(this._dragPath).y}}))}},{key:"_onDragLeave",value:function(i){this._element.dispatchEvent(new CustomEvent("file-out",{detail:Gt(i)})),this._dragPath=null}},{key:"destroy",value:function(){var i=this;h.forEach(function(e){i._element.removeEventListener(e,i)}),Kt(this._element),this._element=null,this._dragPath=null,this._accept=null}},{key:"element",get:function(){return this._element}},{key:"dragPath",get:function(){return this._dragPath}},{key:"enabled",get:function(){return this._element.style.display===""},set:function(i){this._element.style.display=i?"":"none"}},{key:"allowURLs",set:function(i){this._allowURLs=i}},{key:"accept",set:function(i){this._accept=i},get:function(){return this._accept}}]),n})()})(),li=(function(){return(function(){function h(){Rt(this,h),this._element=null,this._inner=null,this._init()}return Tt(h,[{key:"_init",value:function(){this._element=F("div","slim-popover"),this._element.setAttribute("data-state","off"),document.body.appendChild(this._element),this._element.addEventListener("touchmove",function(t){t.preventDefault()},!0)}},{key:"show",value:function(){var t=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){};this._element.setAttribute("data-state","on"),x(this._element,{fromOpacity:0,opacity:1,duration:350,complete:function(){nt(t._element),i()}})}},{key:"hide",value:function(){var t=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){};x(this._element,{fromOpacity:1,opacity:0,duration:500,complete:function(){nt(t._element),t._element.setAttribute("data-state","off"),i()}})}},{key:"destroy",value:function(){this._element.parentNode&&(this._element.parentNode.removeChild(this._element),this._element=null,this._inner=null)}},{key:"inner",set:function(t){this._inner=t,this._element.firstChild&&this._element.removeChild(this._element.firstChild),this._element.appendChild(this._inner)}},{key:"className",set:function(t){this._element.className="slim-popover"+(t===null?"":" "+t)}}]),h})()})(),Vt=function(n,t){return n.split(t).map(function(i){return parseInt(i,10)})},fi=function(n){return n.nodeName==="DIV"||n.nodeName==="SPAN"},gt={AUTO:"auto",INITIAL:"initial",MANUAL:"manual"},pi=["x","y","width","height"],ye=["file-invalid-drop","file-invalid","file-drop","file-over","file-out","click"],we=["cancel","confirm"],Qt=["remove","edit","download","upload"],mt=null,Ut=0,Se=`
<div class="slim-loader">
	<svg>
		<path class="slim-loader-background" fill="none" stroke-width="3" />
		<path class="slim-loader-foreground" fill="none" stroke-width="3" />
	</svg>
</div>
`,be=`
<div class="slim-upload-status"></div>
`,Lt=function(n){var t=n.split(",");return{width:parseInt(t[0],10),height:parseInt(t[1],10)}},rt=(function(){function h(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Rt(this,h),mt||(mt=new li),this._uid=Ut++,this._options=ae(h.options(),t),this._options.forceSize&&(typeof this._options.forceSize=="string"&&(this._options.forceSize=Lt(this._options.forceSize)),this._options.ratio=this._options.forceSize.width+":"+this._options.forceSize.height,this._options.size=it(this._options.forceSize)),typeof this._options.size=="string"&&(this._options.size=Lt(this._options.size)),typeof this._options.minSize=="string"&&(this._options.minSize=Lt(this._options.minSize)),typeof this._options.post=="string"&&(this._options.post=this._options.post.split(",").map(function(i){return i.trim()})),this._originalElement=n,this._originalElementInner=n.innerHTML,this._originalElementAttributes=re(n),fi(n)?this._element=n:(this._element=oi(n),this._element.className=n.className,n.className="",this._element.setAttribute("data-ratio",this._options.ratio)),this._element.classList.add("slim"),this._element.setAttribute("data-state","init"),this._state=[],this._timers=[],this._input=null,this._inputReference=null,this._output=null,this._ratio=null,this._isRequired=!1,this._imageHopper=null,this._imageEditor=null,this._progressEnabled=!0,this._data={},this._resetData(),this._drip=null,this._hasInitialImage=!1,this._initialCrop=this._options.crop,this._initialRotation=this._options.rotation&&this._options.rotation%90===0?this._options.rotation:null,this._isBeingDestroyed=!1,h.supported?this._init():this._fallback()}return Tt(h,[{key:"setRotation",value:function(t,i){if(!(typeof t!="number"&&t%90!==0)){this._data.actions.rotation=t;var e=this._data.actions.rotation%180!==0;if(this._data.input.image){var o=e?this._data.input.image.height:this._data.input.image.width,a=e?this._data.input.image.width:this._data.input.image.height;this._data.actions.crop=Mt(o,a,this._ratio),this._data.actions.crop.type=gt.AUTO}this._data.input.image&&i&&this._manualTransform(i)}}},{key:"setSize",value:function(t,i){typeof t=="string"&&(t=Lt(t)),!(!t||!t.width||!t.height)&&(this._options.size=it(t),this._data.actions.size=it(t),this._data.input.image&&i&&this._manualTransform(i))}},{key:"setForceSize",value:function(t,i){typeof t=="string"&&(t=Lt(t)),!(!t||!t.width||!t.height)&&(this._options.size=it(t),this._options.forceSize=it(t),this._data.actions.size=it(t),this.setRatio(this._options.forceSize.width+":"+this._options.forceSize.height,i))}},{key:"setRatio",value:function(t,i){var e=this;if(!(!t||typeof t!="string")&&(this._options.ratio=t,this._isFixedRatio())){var o=Vt(this._options.ratio,":");this._ratio=o[1]/o[0],this._data.input.image&&i?this._cropAuto(function(a){e._scaleDropArea(e._ratio),i&&i(a)}):(this._data.input.image&&(this._data.actions.crop=Mt(this._data.input.image.width,this._data.input.image.height,this._ratio),this._data.actions.crop.type=gt.AUTO),this._scaleDropArea(this._ratio),i&&i(null))}}},{key:"isAttachedTo",value:function(t){return this._element===t||this._originalElement===t}},{key:"isDetached",value:function(){return this._element.parentNode===null}},{key:"load",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=arguments[2];typeof i=="function"?e=i:(this._options.crop=i.crop,this._options.rotation=i.rotation,this._initialRotation=i.rotation&&i.rotation%90===0?i.rotation:null,this._initialCrop=this._options.crop),this._load(t,e,{blockPush:i.blockPush})}},{key:"upload",value:function(t){this._doUpload(t)}},{key:"download",value:function(){this._doDownload()}},{key:"remove",value:function(){return this._doRemove()}},{key:"destroy",value:function(){this._doDestroy()}},{key:"edit",value:function(){this._doEdit()}},{key:"crop",value:function(t,i){this._crop(t.x,t.y,t.width,t.height,i)}},{key:"containsImage",value:function(){return this._data.input.name!==null}},{key:"_canInstantEdit",value:function(){return this._options.instantEdit&&!this._isInitialising}},{key:"_getFileInput",value:function(){return this._element.querySelector("input[type=file]")}},{key:"_getInitialImage",value:function(){return this._element.querySelector("img")}},{key:"_getInputElement",value:function(){return this._getFileInput()||this._getInitialImage()}},{key:"_getRatioSpacerElement",value:function(){return this._element.children[0]}},{key:"_isImageOnly",value:function(){return this._input.nodeName!=="INPUT"}},{key:"_isFixedRatio",value:function(){return this._options.ratio.indexOf(":")!==-1}},{key:"_isAutoCrop",value:function(){return this._data.actions.crop.type===gt.AUTO}},{key:"_toggleButton",value:function(t,i){ai('.slim-btn[data-action="'+t+'"]',i,this._element)}},{key:"_clearState",value:function(){this._state=[],this._updateState()}},{key:"_removeState",value:function(t){this._state=this._state.filter(function(i){return i!==t}),this._updateState()}},{key:"_addState",value:function(t){St(t,this._state)||(this._state.push(t),this._updateState())}},{key:"_updateState",value:function(){this._element&&this._element.setAttribute("data-state",this._state.join(","))}},{key:"_resetData",value:function(){this._data={server:null,meta:it(this._options.meta),input:{field:this._inputReference,name:null,type:null,width:0,height:0,file:null},output:{image:null,width:0,height:0},actions:{rotation:null,crop:null,size:null}},this._output&&(this._output.value=""),ei(this._getFileInput())}},{key:"_init",value:function(){var t=this;if(this._isInitialising=!0,this._addState("empty"),St("input",this._options.post)&&(this._inputReference="slim_input_"+this._uid),this._input=this._getInputElement(),this._input||(this._input=F("input"),this._input.type="file",this._element.appendChild(this._input)),this._isRequired=this._input.required===!0,this._output=this._element.querySelector("input[type=hidden]"),!this._output)this._output=F("input"),this._output.type="hidden",this._output.name=this._input.name||this._options.defaultInputName,this._element.appendChild(this._output);else{var i=null;try{i=JSON.parse(this._output.value)}catch{}if(i){var e=new Image;e.src=i.output.image,e.setAttribute("data-filename",i.output.name),this._element.insertBefore(e,this._element.firstChild)}}this._input.removeAttribute("name");var o=F("div","slim-area"),a=this._getInitialImage(),s=(a||{}).src,f=a?a.getAttribute("data-filename"):null;s?this._hasInitialImage=!0:(this._initialCrop=null,this._initialRotation=null);var l=`
		<div class="slim-result">
			<img class="in" style="opacity:0" `+(s?'src="'+s+'"':"")+`><img><img style="opacity:0">
		</div>`;if(this._isImageOnly())o.innerHTML=`
				`+Se+`
				`+be+`
				`+l+`
				<div class="slim-status"><div class="slim-label-loading">`+(this._options.labelLoading||"")+`</div></div>
			`;else{St("input",this._options.post)&&(this._data.input.field=this._inputReference,this._options.service||(this._input.name=this._inputReference));var v=void 0;!this._input.hasAttribute("accept")||this._input.getAttribute("accept")==="image/*"?(v=ze(),this._input.setAttribute("accept",v.join(","))):v=this._input.accept.split(",").map(function(d){return d.trim()}).filter(function(d){return d.length>0}),this._imageHopper=new ui,this._imageHopper.accept=v,this._imageHopper.allowURLs=typeof this._options.fetcher=="string",this._element.appendChild(this._imageHopper.element),ye.forEach(function(d){t._imageHopper.element.addEventListener(d,t)}),o.innerHTML=`
				`+Se+`
				`+be+`
				<div class="slim-drip"><span><span></span></span></div>
				<div class="slim-status"><div class="slim-label">`+(this._options.label||"")+'</div><div class="slim-label-loading">'+(this._options.labelLoading||"")+`</div></div>
				`+l+`
			`,this._input.addEventListener("change",this)}if(this._element.appendChild(o),this._btnGroup=F("div","slim-btn-group"),this._btnGroup.style.display="none",this._element.appendChild(this._btnGroup),Qt.filter(function(d){return t._isButtonAllowed(d)}).forEach(function(d){var y=zt(d),E=t._options["button"+y+"Label"],m=t._options["button"+y+"Title"]||E,_=t._options["button"+y+"ClassName"],k=F("button","slim-btn slim-btn-"+d+(_?" "+_:""));k.innerHTML=E,k.title=m,k.type="button",k.addEventListener("click",t),k.setAttribute("data-action",d),t._btnGroup.appendChild(k)}),this._isFixedRatio()){var p=Vt(this._options.ratio,":");this._ratio=p[1]/p[0],this._scaleDropArea(this._ratio)}this._updateProgress(.5),s?this._load(s,function(){t._onInit()},{name:f}):this._onInit()}},{key:"_onInit",value:function(){var t=this;this._isInitialising=!1;var i=function(){var o=setTimeout(function(){t._options.didInit.apply(t,[t.data,t])},0);t._timers.push(o)};this._options.saveInitialImage&&this.containsImage()?this._options.service||this._save(function(){i()},!1):(this._options.service&&this.containsImage()&&this._toggleButton("upload",!1),i())}},{key:"_updateProgress",value:function(t){if(t=Math.min(.99999,t),!!this._element&&this._progressEnabled){var i=this._element.querySelector(".slim-loader");if(i){var e=i.offsetWidth,o=i.querySelectorAll("path"),a=parseInt(o[0].getAttribute("stroke-width"),10);o[0].setAttribute("d",me(e*.5,e*.5,e*.5-a,.9999)),o[1].setAttribute("d",me(e*.5,e*.5,e*.5-a,t))}}}},{key:"_startProgress",value:function(t){var i=this;if(this._element){this._progressEnabled=!1;var e=this._element.querySelector(".slim-loader");if(e){var o=e.children[0];this._stopProgressLoop(function(){e.removeAttribute("style"),o.removeAttribute("style"),i._progressEnabled=!0,i._updateProgress(0),i._progressEnabled=!1,x(o,{fromOpacity:0,opacity:1,duration:250,complete:function(){i._progressEnabled=!0,t&&t()}})})}}}},{key:"_stopProgress",value:function(){var t=this;if(this._element){var i=this._element.querySelector(".slim-loader");if(i){var e=i.children[0];this._updateProgress(1),x(e,{fromOpacity:1,opacity:0,duration:250,complete:function(){i.removeAttribute("style"),e.removeAttribute("style"),t._updateProgress(.5),t._progressEnabled=!1}})}}}},{key:"_startProgressLoop",value:function(){if(this._element){var t=this._element.querySelector(".slim-loader");if(t){var i=t.children[0];t.removeAttribute("style"),i.removeAttribute("style"),this._updateProgress(.5);var e=1e3;x(t,"stop"),x(t,{rotation:[0,0,-(Math.PI*2)*e],easing:"linear",duration:e*1e3}),x(i,{fromOpacity:0,opacity:1,duration:250})}}}},{key:"_stopProgressLoop",value:function(t){if(this._element){var i=this._element.querySelector(".slim-loader");if(i){var e=i.children[0];x(e,{fromOpacity:parseFloat(e.style.opacity),opacity:0,duration:250,complete:function(){x(i,"stop"),i.removeAttribute("style"),e.removeAttribute("style"),t&&t()}})}}}},{key:"_isButtonAllowed",value:function(t){return t==="edit"?this._options.edit:t==="download"?this._options.download:t==="upload"?!(!this._options.service||this._options.push):t==="remove"?!this._isImageOnly():!0}},{key:"_fallback",value:function(){var t=F("div","slim-area");t.innerHTML=`
			<div class="slim-status"><div class="slim-label">`+(this._options.label||"")+`</div></div>
		`,this._element.appendChild(t),this._throwError(this._options.statusNoSupport)}},{key:"handleEvent",value:function(t){switch(t.type){case"click":this._onClick(t);break;case"change":this._onChange(t);break;case"cancel":this._onCancel(t);break;case"confirm":this._onConfirm(t);break;case"file-over":this._onFileOver(t);break;case"file-out":this._onFileOut(t);break;case"file-drop":this._onDropFile(t);break;case"file-invalid":this._onInvalidFile(t);break;case"file-invalid-drop":this._onInvalidFileDrop(t);break}}},{key:"_getIntro",value:function(){return this._element.querySelector(".slim-result .in")}},{key:"_getOutro",value:function(){return this._element.querySelector(".slim-result .out")}},{key:"_getInOut",value:function(){return this._element.querySelectorAll(".slim-result img")}},{key:"_getDrip",value:function(){return this._drip||(this._drip=this._element.querySelector(".slim-drip > span")),this._drip}},{key:"_throwError",value:function(t){this._addState("error"),this._element.querySelector(".slim-label").style.display="none";var i=this._element.querySelector(".slim-error");i||(i=F("div","slim-error"),this._element.querySelector(".slim-status").appendChild(i)),i.innerHTML=t,this._options.didThrowError.apply(this,[t])}},{key:"_removeError",value:function(){this._removeState("error"),this._element.querySelector(".slim-label").style.display="";var t=this._element.querySelector(".slim-error");t&&t.parentNode.removeChild(t)}},{key:"_openFileDialog",value:function(){this._removeError(),this._input.click()}},{key:"_onClick",value:function(t){var i=this,e=t.target.classList,o=t.target;if(e.contains("slim-file-hopper")){t.preventDefault(),this._openFileDialog();return}switch(o.getAttribute("data-action")){case"remove":this._options.willRemove.apply(this,[this.data,function(){i._doRemove()}]);break;case"edit":this._doEdit();break;case"download":this._doDownload();break;case"upload":this._doUpload();break}}},{key:"_onInvalidFileDrop",value:function(){this._onInvalidFile(),this._removeState("file-over");var t=this._getDrip();x(t.firstChild,{fromScale:[.5,.5],scale:[0,0],fromOpacity:.5,opacity:0,duration:150,complete:function(){nt(t.firstChild)}})}},{key:"_onInvalidFile",value:function(){var t=this._imageHopper.accept.map(At),i=this._options.statusFileType.replace("$0",t.join(", "));this._throwError(i)}},{key:"_onImageTooSmall",value:function(){var t=this._options.statusImageTooSmall.replace("$0",this._options.minSize.width+"  "+this._options.minSize.height);this._throwError(t)}},{key:"_onOverWeightFile",value:function(){var t=this._options.statusFileSize.replace("$0",this._options.maxFileSize);this._throwError(t)}},{key:"_onLocalURLProblem",value:function(t){this._throwError(this._options.statusLocalUrlProblem||t)}},{key:"_onRemoteURLProblem",value:function(t){this._throwError(t)}},{key:"_onFileOver",value:function(t){this._addState("file-over"),this._removeError();var i=this._getDrip(),e=x.createMatrix();e.translate(t.detail.x,t.detail.y,0),x.setElementTransform(i,e),this._imageHopper.dragPath.length==1&&(i.style.opacity=1,x(i.firstChild,{fromOpacity:0,opacity:.5,fromScale:[0,0],scale:[.5,.5],duration:150}))}},{key:"_onFileOut",value:function(t){this._removeState("file-over"),this._removeState("file-invalid"),this._removeError();var i=this._getDrip(),e=x.createMatrix();e.translate(t.detail.x,t.detail.y,0),x.setElementTransform(i,e),x(i.firstChild,{fromScale:[.5,.5],scale:[0,0],fromOpacity:.5,opacity:0,duration:150,complete:function(){nt(i.firstChild)}})}},{key:"_onDropFile",value:function(t){var i=this;this._removeState("file-over");var e=this._getDrip(),o=x.createMatrix();o.translate(t.detail.x,t.detail.y,0),x.setElementTransform(e,o);var a=this._imageHopper.dragPath.length,s=this._imageHopper.dragPath[a-Math.min(10,a)],f=t.detail.x-s.x,l=t.detail.y-s.y;x(e,{fromPosition:[t.detail.x,t.detail.y,0],position:[t.detail.x+f,t.detail.y+l,0],duration:200}),x(e.firstChild,{fromScale:[.5,.5],scale:[2,2],fromOpacity:1,opacity:0,duration:200,complete:function(){nt(e.firstChild),i._load(t.target.files[0])}})}},{key:"_onChange",value:function(t){t.target.files.length&&this._load(t.target.files[0])}},{key:"_load",value:function(t,i){var e=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this._isBeingDestroyed){if(this.containsImage()){clearTimeout(this._replaceTimeout),this._doRemove(function(){e._replaceTimeout=setTimeout(function(){e._load(t,i,o)},100)});return}this._removeState("empty"),this._addState("busy"),this._startProgressLoop(),this._imageHopper&&(this._imageHopper.enabled=!1),clearTimeout(this._loadTimeout);var a=function(){clearTimeout(e._loadTimeout),e._loadTimeout=setTimeout(function(){e._isBeingDestroyed||(e._addState("loading"),x(e._element.querySelector(".slim-label-loading"),{fromOpacity:0,opacity:1,duration:250}))},500)},s=function(){e._imageHopper&&(e._imageHopper.enabled=!0),e._removeState("loading"),e._removeState("busy"),e._addState("empty"),e._stopProgressLoop()};if(typeof t=="string"){fe(t)?this._load(Jt(t),i,o):(a(),pe(t,this._options.willLoad,function(l){e._load(l,i,o)},function(l){setTimeout(function(){s(),e._onLocalURLProblem("<p>"+l+"</p>"),i&&i.apply(e,["local-url-problem"])},500)}));return}else if(typeof t.remote<"u"){if(fe(t.remote)){this._load(Jt(t.remote),i,o);return}this._options.fetcher&&Ue(this._options.fetcher,this._options.willFetch,this._options.willLoad,t.remote,function(l){s(),e._onRemoteURLProblem("<p>"+l+"</p>"),i&&i.apply(e,["remote-url-problem"])},function(l){e._load(l,i,o)});return}var f=t;if(this._imageHopper&&this._imageHopper.accept.indexOf(f.type)===-1){s(),this._onInvalidFile(),i&&i.apply(this,["file-invalid"]);return}if(f.size&&this._options.maxFileSize&&Oe(f.size)>this._options.maxFileSize){s(),this._onOverWeightFile(),i&&i.apply(this,["file-too-big"]);return}this._imageEditor&&this._imageEditor.dirty(),this._data.input.name=o&&o.name?o.name:Be(f),this._data.input.type=le(f),this._data.input.size=f.size,this._data.input.file=f,We(f,this._options.internalCanvasSize,function(l,v){var p=function(){e._imageHopper&&(e._imageHopper.enabled=!0),e._removeState("loading"),e._removeState("busy"),e._addState("empty"),e._stopProgressLoop(),e._resetData()};if(!l){p(),i&&i.apply(e,["file-not-found"]);return}if(!Ve(l,e._options.minSize)){p(),e._onImageTooSmall(),i&&i.apply(e,["image-too-small"]);return}var d=e._options.didLoad.apply(e,[f,l,v,e]);if(d!==!0){p(),d!==!1&&e._throwError(d),i&&i.apply(e,[d]);return}e._removeState("loading");var y=function(m){e._imageHopper&&e._options.dropReplace&&(e._imageHopper.enabled=!0);var _=e._getIntro(),k={fromScale:[1.25,1.25],scale:[1,1],fromOpacity:0,opacity:1,complete:function(){nt(_),_.style.opacity=1,m()}};e.isDetached()?k.duration=1:(k.easing="spring",k.springConstant=.3,k.springDeceleration=.7),e._canInstantEdit()&&(k.delay=500,k.duration=1,e._doEdit()),x(_,k)};e._loadCanvas(l,function(E){e._addState("preview"),y(function(){!e._canInstantEdit()&&!E&&e._showButtons(),E||(e._stopProgressLoop(),e._removeState("busy")),i&&i.apply(e,[null,e.data])})},function(){e._canInstantEdit()||e._showButtons(),e._removeState("busy")},{blockPush:o.blockPush})})}}},{key:"_loadCanvas",value:function(t,i,e,o){var a=this;if(o||(o={}),!this._isBeingDestroyed){this._data.input.image=t,this._data.input.width=t.width,this._data.input.height=t.height,this._initialRotation&&(this._data.actions.rotation=this._initialRotation,this._initialRotation=null);var s=this._data.actions.rotation%180!==0;this._isFixedRatio()||(this._initialCrop?this._ratio=this._initialCrop.height/this._initialCrop.width:this._ratio=s?t.width/t.height:t.height/t.width,this._scaleDropArea(this._ratio));var f=function(){a._options.size&&(a._data.actions.size={width:a._options.size.width,height:a._options.size.height}),a._applyTransforms(t,function(v){var p=a._getIntro(),d=p.offsetWidth/v.width,y=!1;a._options.service&&a._options.push&&!o.blockPush&&!a._hasInitialImage&&!a._canInstantEdit()&&(y=!0,a._stopProgressLoop(function(){a._startProgress(function(){a._updateProgress(.1)})})),a._canInstantEdit()||a._save(function(){a._isBeingDestroyed||y&&(a._stopProgress(),e())},y);var E=a._options.devicePixelRatio==="auto"?window.devicePixelRatio:a._options.devicePixelRatio;p.src="",p.src=Dt(v,d*E).toDataURL(),p.onload=function(){p.onload=null,!a._isBeingDestroyed&&i&&i(y)}})};this._initialCrop?(this._data.actions.crop=it(this._initialCrop),this._data.actions.crop.type=gt.INITIAL,this._initialCrop=null,f()):this._options.willCropInitial.apply(this,[this.data,function(l){l?(a._data.actions.crop=l,a._data.actions.crop.type=gt.INITIAL):(a._data.actions.crop=Mt(s?t.height:t.width,s?t.width:t.height,a._ratio),a._data.actions.crop.type=gt.AUTO),f()},this])}}},{key:"_applyTransforms",value:function(t,i){var e=this,o=it(this._data.actions);o.filters={sharpen:this._options.filterSharpen/100},this._options.forceMinSize?o.minSize=this._options.minSize:o.minSize={width:0,height:0},qe(t,o,function(a){var s=a;if(e._options.forceSize||e._options.size&&Je(e._options.size,a)==1){s=F("canvas"),s.width=e._options.size.width,s.height=e._options.size.height;var f=s.getContext("2d");f.drawImage(a,0,0,e._options.size.width,e._options.size.height)}if(e._options.forceMinSize&&e._options.size&&e._options.minSize.width===e._options.size.width&&e._options.minSize.height===e._options.size.height&&(s.width<e._options.minSize.width||s.height<e._options.minSize.height)){var l=Math.max(s.width,e._options.minSize.width),v=Math.max(s.height,e._options.minSize.height);s=F("canvas"),s.width=l,s.height=v;var p=s.getContext("2d");p.drawImage(a,0,0,l,v)}if(e._options.forceMinSize&&e._ratio===1&&(s.width<e._options.minSize.width||s.height<e._options.minSize.height)){s=F("canvas"),s.width=e._options.minSize.width,s.height=e._options.minSize.height;var d=s.getContext("2d");d.drawImage(a,0,0,s.width,s.height)}e._data.output.width=s.width,e._data.output.height=s.height,e._data.output.image=s,e._onTransformCanvas(function(y){e._data=y,e._options.didTransform.apply(e,[e.data,e]),i(e._data.output.image)})})}},{key:"_onTransformCanvas",value:function(t){this._options.willTransform.apply(this,[this.data,t,this])}},{key:"_appendEditor",value:function(){var t=this;this._imageEditor||(this._imageEditor=new Zt(F("div"),{minSize:this._options.minSize,devicePixelRatio:this._options.devicePixelRatio,buttonConfirmClassName:this._options.buttonConfirmClassName,buttonCancelClassName:this._options.buttonCancelClassName,buttonRotateClassName:this._options.buttonRotateClassName,buttonConfirmLabel:this._options.buttonConfirmLabel,buttonCancelLabel:this._options.buttonCancelLabel,buttonRotateLabel:this._options.buttonRotateLabel,buttonConfirmTitle:this._options.buttonConfirmTitle,buttonCancelTitle:this._options.buttonCancelTitle,buttonRotateTitle:this._options.buttonRotateTitle}),we.forEach(function(i){t._imageEditor.element.addEventListener(i,t)}))}},{key:"_scaleDropArea",value:function(t){var i=this._getRatioSpacerElement();!i||!this._element||(i.style.marginBottom=t*100+"%",this._element.setAttribute("data-ratio","1:"+t))}},{key:"_onCancel",value:function(t){this._removeState("editor"),this._options.didCancel.apply(this,[this]),this._showButtons(),this._hideEditor(),this._options.instantEdit&&!this._hasInitialImage&&this._isAutoCrop()&&this._doRemove()}},{key:"_onConfirm",value:function(t){var i=this,e=this._options.service&&this._options.push;e?this._startProgress(function(){i._updateProgress(.1)}):this._startProgressLoop(),this._removeState("editor"),this._addState("busy"),this._output.value="",this._data.actions.rotation=t.detail.rotation,this._data.actions.crop=t.detail.crop,this._data.actions.crop.type=gt.MANUAL,this._applyTransforms(this._data.input.image,function(o){i._options.didConfirm.apply(i,[i.data,i]);var a=i._getInOut(),s=a[0].className==="out"?a[0]:a[1],f=s===a[0]?a[1]:a[0];s.className="in",s.style.opacity="0",s.style.zIndex="2",f.className="out",f.style.zIndex="1";var l=i._options.devicePixelRatio==="auto"?window.devicePixelRatio:i._options.devicePixelRatio;s.src="",s.src=Dt(o,s.offsetWidth/o.width*l).toDataURL(),s.onload=function(){s.onload=null,i._options.ratio==="free"&&(i._ratio=s.naturalHeight/s.naturalWidth,i._scaleDropArea(i._ratio)),i._hideEditor();var v=setTimeout(function(){i._showPreview(s,function(){i._save(function(p,d,y){i._toggleButton("upload",!0),e?i._stopProgress():i._stopProgressLoop(),i._removeState("busy"),i._showButtons()},e)})},250);i._timers.push(v)}})}},{key:"_cropAuto",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(o){},i=this._data.actions.rotation%180!==0,e=Mt(i?this._data.input.image.height:this._data.input.image.width,i?this._data.input.image.width:this._data.input.image.height,this._ratio);this._crop(e.x,e.y,e.width,e.height,t,gt.AUTO)}},{key:"_crop",value:function(t,i,e,o){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:function(f){},s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:gt.MANUAL;this._output.value="",this._data.actions.crop={x:t,y:i,width:e,height:o},this._data.actions.crop.type=s,this._manualTransform(a)}},{key:"_manualTransform",value:function(t){var i=this;this._startProgressLoop(),this._addState("busy"),this._applyTransforms(this._data.input.image,function(e){var o=i._getInOut(),a=o[0].className==="out"?o[0]:o[1],s=a===o[0]?o[1]:o[0];a.className="in",a.style.opacity="1",a.style.zIndex="2",s.className="out",s.style.zIndex="0";var f=i._options.devicePixelRatio==="auto"?window.devicePixelRatio:i._options.devicePixelRatio;a.src="",a.src=Dt(e,a.offsetWidth/e.width*f).toDataURL(),a.onload=function(){a.onload=null,i._options.ratio==="free"&&(i._ratio=a.naturalHeight/a.naturalWidth,i._scaleDropArea(i._ratio));var l=i._options.service&&i._options.push,v=function(){i._save(function(d,y,E){l||i._stopProgressLoop(),i._removeState("busy"),t.apply(i,[i.data])},l)};l?i._startProgress(v):v()}})}},{key:"_save",value:function(){var t=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!this._isBeingDestroyed){var o=this.dataBase64;!this._options.service&&!(this._isInitialising&&!this._isImageOnly())&&this._options.willSave.apply(this,[o,function(a){t._store(a),t._options.didSave.apply(t,[a,t])},this]),!this._isBeingDestroyed&&(this._options.service&&e&&this._options.willSave.apply(this,[o,function(a){t._addState("upload"),t._imageHopper&&t._options.dropReplace&&(t._imageHopper.enabled=!1),t._upload(a,function(s,f){t._imageHopper&&t._options.dropReplace&&(t._imageHopper.enabled=!0),s||t._storeServerResponse(f),t._options.didUpload.apply(t,[s,a,f,t]),t._removeState("upload"),i(s,a,f)})},this]),(!this._options.service||!e)&&i())}}},{key:"_storeServerResponse",value:function(t){this._isRequired&&(this._input.required=!1),this._data.server=t,this._output.value=(typeof t>"u"?"undefined":Ot(t))==="object"?JSON.stringify(this._data.server):t}},{key:"_store",value:function(t){this._isRequired&&(this._input.required=!1),this._output.value=JSON.stringify(t)}},{key:"_upload",value:function(t,i){var e=this;this.requestOutput(function(o,a){var s=e._element.querySelector(".slim-upload-status"),f=e._options.willRequest,l=function(y,E){e._updateProgress(Math.max(.1,y/E))},v=function(y){var E=setTimeout(function(){if(!e._isBeingDestroyed){s.innerHTML=e._options.statusUploadSuccess,s.setAttribute("data-state","success"),s.style.opacity=1;var m=setTimeout(function(){s.style.opacity=0},2e3);e._timers.push(m)}},250);e._timers.push(E),i(null,y)},p=function(y){var E="";y==="file-too-big"?E=e._options.statusContentLength:E=e._options.didReceiveServerError.apply(e,[y,e._options.statusUnknownResponse,e]);var m=setTimeout(function(){s.innerHTML=E,s.setAttribute("data-state","error"),s.style.opacity=1},250);e._timers.push(m),i(y)};typeof e._options.service=="string"?Le(e._options.service,e._options.uploadMethod,a,f,l,v,p):typeof e._options.service=="function"&&e._options.service.apply(e,[e._options.serviceFormat==="file"?o:a,l,v,p,e])},t)}},{key:"requestOutput",value:function(t,i){var e=this;if(!this._data.input.file){t(null,null);return}i||(i=this.dataBase64),b.parseMetaData(this._data.input.file,function(o){var a=[],s=new FormData;if(St("input",e._options.post)&&(a.push(e._data.input.file),s.append(e._inputReference,e._data.input.file,e._data.input.file.name)),St("output",e._options.post)&&e._data.output.image!==null&&e._options.uploadBase64===!1){var f=Jt(i.output.image,i.output.name);if(o.imageHead&&e._options.copyImageHead)try{f=new Blob([o.imageHead,b.blobSlice.call(f,20)],{type:$t(i.output.image)}),f=Yt(f,i.output.name)}catch{}a.push(f);var l="slim_output_"+e._uid;i.output.image=null,i.output.field=l,s.append(l,f,i.output.name)}s.append(e._output.name,JSON.stringify(i)),t(a,s)},{maxMetaDataSize:262144,disableImageHead:!1})}},{key:"_showEditor",value:function(){mt.className=this._options.popoverClassName,mt.show(),this._imageEditor.show()}},{key:"_hideEditor",value:function(){this._imageEditor.hide();var t=setTimeout(function(){mt.hide()},250);this._timers.push(t)}},{key:"_showPreview",value:function(t,i){x(t,{fromPosition:[0,50,0],position:[0,0,0],fromScale:[1.5,1.5],scale:[1,1],fromOpacity:0,opacity:1,easing:"spring",springConstant:.3,springDeceleration:.7,complete:function(){nt(t),i&&i()}})}},{key:"_hideResult",value:function(t){var i=this._getIntro();i&&x(i,{fromScale:[1,1],scale:[.5,.5],fromOpacity:1,opacity:0,easing:"spring",springConstant:.3,springDeceleration:.75,complete:function(){nt(i),t&&t()}})}},{key:"_showButtons",value:function(t){if(this._btnGroup){this._btnGroup.style.display="";var i={fromScale:[.5,.5],scale:[1,1],fromPosition:[0,10,0],position:[0,0,0],fromOpacity:0,opacity:1,complete:function(){nt(this)},allDone:function(){t&&t()}};this.isDetached()?i.duration=1:(i.delay=function(e){return 250+e*50},i.easing="spring",i.springConstant=.3,i.springDeceleration=.85),x(this._btnGroup.childNodes,i)}}},{key:"_hideButtons",value:function(t){var i=this;if(this._btnGroup){var e={fromScale:[1,1],scale:[.85,.85],fromOpacity:1,opacity:0,allDone:function(){i._btnGroup.style.display="none",t&&t()}};this.isDetached()?e.duration=1:(e.easing="spring",e.springConstant=.3,e.springDeceleration=.75),x(this._btnGroup.childNodes,e)}}},{key:"_hideStatus",value:function(){var t=this._element.querySelector(".slim-upload-status");t.style.opacity=0}},{key:"_doEdit",value:function(){var t=this;this._data.input.image&&(this._addState("editor"),this._imageEditor||this._appendEditor(),this._imageEditor.showRotateButton=this._options.rotateButton,mt.inner=this._imageEditor.element,this._imageEditor.open(Bt(this._data.input.image),this._options.ratio==="free"?null:this._ratio,this._data.actions.crop,this._data.actions.rotation,function(){t._showEditor(),t._hideButtons(),t._hideStatus()}))}},{key:"_doRemove",value:function(t){var i=this;if(!this._isImageOnly()){this._clearState(),this._addState("empty"),this._hasInitialImage=!1,this._imageHopper&&(this._imageHopper.enabled=!0),this._isRequired&&(this._input.required=!0);var e=this._getOutro();e&&(e.style.opacity="0");var o=this.data;this._resetData();var a=setTimeout(function(){i._isBeingDestroyed||(i._hideButtons(function(){i._toggleButton("upload",!0)}),i._hideStatus(),i._hideResult(),i._options.didRemove.apply(i,[o,i]),t&&t())},this.isDetached()?0:250);return this._timers.push(a),o}}},{key:"_doUpload",value:function(t){var i=this;this._data.input.image&&(this._addState("upload"),this._startProgress(),this._hideButtons(function(){i._toggleButton("upload",!1),i._save(function(e,o,a){i._removeState("upload"),i._stopProgress(),t&&t.apply(i,[e,o,a]),e&&i._toggleButton("upload",!0),i._showButtons()})}))}},{key:"_doDownload",value:function(){var t=this._data.output.image;t&&ri(this._data,this._options.jpegCompression,this._options.forceType)}},{key:"_doDestroy",value:function(){var t=this;this._isBeingDestroyed=!0,this._timers.forEach(function(o){clearTimeout(o)}),this._timers=[],x(this._element,"detach"),this._imageHopper&&(ye.forEach(function(o){t._imageHopper.element.removeEventListener(o,t)}),this._imageHopper.destroy(),this._imageHopper=null),this._imageEditor&&(we.forEach(function(o){t._imageEditor.element.removeEventListener(o,t)}),this._imageEditor.destroy(),this._imageEditor=null),_e(this._btnGroup.children).forEach(function(o){o.removeEventListener("click",t)}),this._input.removeEventListener("change",this),this._element!==this._originalElement&&this._element.parentNode&&this._element.parentNode.replaceChild(this._originalElement,this._element),this._originalElement.innerHTML=this._originalElementInner;function i(o,a){return a.filter(function(s){return o.name===s.name&&o.value===s.value}).length!==0}var e=re(this._originalElement);e.forEach(function(o){i(o,t._originalElementAttributes)||t._originalElement.removeAttribute(o.name)}),this._originalElementAttributes.forEach(function(o){i(o,e)||t._originalElement.setAttribute(o.name,o.value)}),Ut=Math.max(0,Ut-1),mt&&Ut===0&&(mt.destroy(),mt=null),this._originalElement=null,this._element=null,this._input=null,this._output=null,this._btnGroup=null,this._options=null}},{key:"dataBase64",get:function(){return ni(this._data,this._options.post,this._options.jpegCompression,this._options.forceType,this._options.service!==null)}},{key:"data",get:function(){return ii(this._data)}},{key:"element",get:function(){return this._element}},{key:"service",set:function(t){this._options.service=t}},{key:"size",set:function(t){this.setSize(t,null)}},{key:"rotation",set:function(t){this.setRotation(t,null)}},{key:"forceSize",set:function(t){this.setForceSize(t,null)}},{key:"ratio",set:function(t){this.setRatio(t,null)}}],[{key:"options",value:function(){var t={edit:!0,instantEdit:!1,uploadBase64:!1,meta:{},ratio:"free",devicePixelRatio:1,size:null,rotation:null,crop:null,post:["output","actions"],service:null,serviceFormat:null,filterSharpen:0,push:!1,defaultInputName:"slim[]",minSize:{width:0,height:0},maxFileSize:null,jpegCompression:null,uploadMethod:"POST",download:!1,saveInitialImage:!1,forceType:!1,forceSize:null,forceMinSize:!0,dropReplace:!0,fetcher:null,internalCanvasSize:{width:4096,height:4096},copyImageHead:!1,rotateButton:!0,popoverClassName:null,label:"<p>Drop your image here</p>",labelLoading:"<p>Loading image...</p>",statusFileType:"<p>Invalid file type, expects: $0.</p>",statusFileSize:"<p>File is too big, maximum file size: $0 MB.</p>",statusNoSupport:"<p>Your browser does not support image cropping.</p>",statusImageTooSmall:"<p>Image is too small, minimum size is: $0 pixels.</p>",statusContentLength:'<span class="slim-upload-status-icon"></span> The file is probably too big',statusUnknownResponse:'<span class="slim-upload-status-icon"></span> An unknown error occurred',statusUploadSuccess:'<span class="slim-upload-status-icon"></span> Saved',statusLocalUrlProblem:null,didInit:function(e){},didLoad:function(e,o,a){return!0},didSave:function(e){},didUpload:function(e,o,a){},didReceiveServerError:function(e,o){return o},didRemove:function(e){},didTransform:function(e){},didConfirm:function(e){},didCancel:function(){},didThrowError:function(){},willCropInitial:function(e,o){o(null)},willTransform:function(e,o){o(e)},willSave:function(e,o){o(e)},willRemove:function(e,o){o()},willRequest:function(e,o){},willFetch:function(e){},willLoad:function(e){}};return Qt.concat(Zt.Buttons).concat("rotate").forEach(function(i){var e=zt(i);t["button"+e+"ClassName"]=null,t["button"+e+"Label"]=e,t["button"+e+"Title"]=e}),t}}]),h})();return(function(){var h=[],n=function(_){for(var k=0,C=h.length;k<C;k++)if(h[k].isAttachedTo(_))return k;return-1};function t(m){return m?"<p>"+m+"</p>":null}function i(m){var _=window,k=m.split(".");return k.forEach(function(C,U){_[k[U]]&&(_=_[k[U]])}),_!==window?_:null}var e=function(_){return _},o=function(_){return _==="true"},a=function(_){return _?_==="true":!0},s=function(_){return t(_)},f=function(_){return _?i(_):null},l=function(_){if(!_)return null;var k=Vt(_,",");return{width:k[0],height:k[1]}},v=function(_){return _?parseFloat(_):null},p=function(_){return _?parseInt(_,10):null},d=function(_){if(!_)return null;var k={};return _.split(",").map(function(C){return parseInt(C,10)}).forEach(function(C,U){k[pi[U]]=C}),k},y={download:o,edit:a,instantEdit:o,minSize:l,size:l,forceSize:l,forceMinSize:a,internalCanvasSize:l,service:function(_){if(typeof _>"u")return null;var k=i(_);return k||_},serviceFormat:function(_){return typeof _>"u"?null:_},fetcher:function(_){return typeof _>"u"?null:_},push:o,rotation:function(_){return typeof _>"u"?null:parseInt(_,10)},crop:d,post:function(_){return _?_.split(",").map(function(k){return k.trim()}):null},defaultInputName:e,ratio:function(_){return _||null},maxFileSize:v,filterSharpen:p,jpegCompression:p,uploadBase64:o,forceType:e,dropReplace:a,saveInitialImage:o,copyImageHead:o,rotateButton:a,label:s,labelLoading:s,popoverClassName:e,devicePixelRatio:e,uploadMethod:e};["FileSize","FileType","NoSupport","ImageTooSmall"].forEach(function(m){y["status"+m]=s}),["ContentLength","UnknownResponse","UploadSuccess","localUrlProblem"].forEach(function(m){y["status"+m]=e}),["Init","Load","Save","Upload","Remove","Transform","ReceiveServerError","Confirm","Cancel","ThrowError"].forEach(function(m){y["did"+m]=f}),["CropInitial","Transform","Save","Remove","Request","Load","Fetch"].forEach(function(m){y["will"+m]=f});var E=["ClassName","Label","Title"];Qt.concat(Zt.Buttons).concat("rotate").forEach(function(m){var _=zt(m);E.forEach(function(k){y["button"+_+k]=e})}),rt.supported=(function(){return!(Object.prototype.toString.call(window.operamini)==="[object OperaMini]"||typeof window.addEventListener>"u"||typeof window.FileReader>"u"||!("slice"in Blob.prototype)||typeof window.URL>"u"||typeof window.URL.createObjectURL>"u")})(),rt.parse=function(m){var _,k,C,U=[];for(_=m.querySelectorAll(".slim:not([data-state])"),C=_.length;C--;)k=_[C],U.push(rt.create(k,rt.getOptionsFromAttributes(k)));return U},rt.getOptionsFromAttributes=function(m){var _=Te(m),k={meta:{}};for(var C in _){var U=y[C],z=_[C];U?(z=U(z),z=z===null?it(rt.options()[C]):z,k[C]=z):C.indexOf("meta")===0&&(k.meta[De(C.substr(4))]=z)}return k},rt.find=function(m){var _=h.filter(function(k){return k.isAttachedTo(m)});return _?_[0]:null},rt.create=function(m,_){if(!rt.find(m)){_||(_=rt.getOptionsFromAttributes(m));var k=new rt(m,_);return h.push(k),k}},rt.destroy=function(m){var _=n(m);return _<0?!1:(h[_].destroy(),h.splice(_,1),!0)}})(),rt})():null,Di=["src"],Oi=ki({__name:"SlimCropper",props:{ratio:{type:String,default:"1:1"},size:{type:String,default:"240,240"},initialImage:{type:String,default:null},service:{type:String,default:"/settings/update-profile"},edit:{type:Boolean,default:!1},fetcher:{type:String,default:"fetch.php"},maxFileSize:{type:[String,Number],default:"2"},containerWidth:{type:String,default:"240px"},containerHeight:{type:String,default:"240px"},containerOverflow:{type:String,default:"hidden"},containerMargin:{type:String,default:"0 auto"},containerBorderRadius:{type:String,default:"0"},containerBorder:{type:String,default:"none"},containerBoxShadow:{type:String,default:"none"},imageObjectFit:{type:String,default:"cover"},imageWidth:{type:String,default:"100%"},imageHeight:{type:String,default:"100%"},containerStyle:{type:Object,default:()=>({})},imageStyle:{type:Object,default:()=>({})},containerClass:{type:[String,Array,Object],default:""}},setup(b){const B=b,Nt=ke(()=>({overflow:B.containerOverflow,width:B.containerWidth,height:B.containerHeight,margin:B.containerMargin,borderRadius:B.containerBorderRadius,border:B.containerBorder,boxShadow:B.containerBoxShadow,...B.containerStyle})),Wt=ke(()=>({objectFit:B.imageObjectFit,width:B.imageWidth,height:B.imageHeight,...B.imageStyle}));let yt=null;const qt=()=>{const x=document.querySelector(".slim");if(x&&!yt){const Et={ratio:B.ratio,size:B.size,maxFileSize:B.maxFileSize,label:"Drop your image here or click to browse"};x.setAttribute("data-ratio",B.ratio),x.setAttribute("data-size",B.size),x.setAttribute("data-service",B.service),x.setAttribute("data-edit",String(B.edit)),x.setAttribute("data-fetcher",B.fetcher),x.setAttribute("data-max-file-size",String(B.maxFileSize)),yt=new Mi(x,Et)}};return Ci(()=>{Ei(()=>{qt()})}),xi(()=>B.initialImage,x=>{x&&yt&&yt.load(x)}),Ti(()=>{yt&&yt.destroy()}),(x,Et)=>(Ee(),Ce("div",{class:Ii(["slim circle",b.containerClass]),style:xe(Nt.value)},[b.initialImage?(Ee(),Ce("img",{key:0,src:b.initialImage,alt:"Profile Image",style:xe(Wt.value)},null,12,Di)):Ri("",!0),Et[0]||(Et[0]=Pi("input",{type:"file",name:"slim[]"},null,-1))],6))}});export{Oi as _};
